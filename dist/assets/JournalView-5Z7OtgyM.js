import{r as i,j as e,h as Y,b as Q,a2 as V,f as v}from"./index-BUL6LB55.js";import{C as q}from"./Card-k44aVk4n.js";import{B as U}from"./Button-CqEssTF4.js";import{J as K}from"./JournalEntryForm-Dob5X59z.js";import{t as u}from"./toast-DfW6NkLH.js";import"./Input-fEXGFBn-.js";import"./accountingService-Cqm7tQaN.js";import"./ImageUpload-DSrilhq8.js";import"./errorUtils-CUS756ws.js";const X=({transactions:h,accounts:T,branches:P,onEdit:I,onDeleteBatch:d,onReverseBatch:r,onViewRelated:w,showApprovalActions:R,onApprove:l,onReject:f,currentUserId:k,isProcessing:g})=>{const[p,j]=i.useState(""),[n,c]=i.useState(new Set),[x,b]=i.useState(!1),[N,y]=i.useState(null),[L,C]=i.useState(!1),[F,D]=i.useState(!1),O=t=>{const o=T.find(S=>S.id===t);return o?`${o.code} - ${o.name}`:"Unknown Account"},M=t=>{var o;return((o=P.find(S=>S.id===t))==null?void 0:o.name)||"Unknown Branch"},m=i.useMemo(()=>h.filter(t=>(t.description||"").toLowerCase().includes(p.toLowerCase())||(t.reference||"").toLowerCase().includes(p.toLowerCase())||t.id&&t.id.toLowerCase().includes(p.toLowerCase())),[h,p]),B=t=>{const o=new Set(n);o.has(t)?o.delete(t):o.add(t),c(o)},z=()=>{if(n.size===m.length&&m.length>0)c(new Set);else{const t=new Set(m.map(o=>o.id));c(t)}},J=async()=>{!d||n.size===0||C(!0)},W=async()=>{if(d){b(!0);try{await d(Array.from(n)),c(new Set)}finally{b(!1),C(!1)}}},E=async()=>{!r||n.size===0||D(!0)},s=async()=>{if(r){b(!0);try{await r(Array.from(n)),c(new Set)}finally{b(!1),D(!1)}}};return e.jsxs("div",{className:"space-y-6 pb-24 relative",children:[e.jsxs("div",{className:"flex justify-between items-center sticky top-0 z-10 bg-gray-50 py-2",children:[e.jsxs("div",{className:"flex items-center gap-4 w-full max-w-xl",children:[e.jsx("div",{className:"flex items-center bg-white px-3 py-2 rounded-xl border border-gray-300 shadow-sm h-[42px]",children:e.jsx("input",{type:"checkbox",className:"h-5 w-5 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded cursor-pointer",checked:m.length>0&&n.size===m.length,onChange:z,title:"Select All Filtered"})}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Search by description, reference, or ID...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-xl focus:ring-indigo-500 focus:border-indigo-500 shadow-sm",value:p,onChange:t=>j(t.target.value)}),e.jsx("svg",{className:"w-5 h-5 text-gray-400 absolute left-3 top-2.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),e.jsxs("div",{className:"text-sm text-gray-500 hidden md:block",children:["Showing ",m.length," entries"]})]}),e.jsxs("div",{className:"space-y-4",children:[m.map(t=>{const o=n.has(t.id),S=t.currency&&t.currency!=="USD";return e.jsxs(q,{className:`hover:shadow-md transition-all duration-200 border ${o?"border-indigo-500 ring-1 ring-indigo-500 bg-indigo-50/10":"border-gray-100"}`,children:[e.jsxs("div",{className:"border-b border-gray-100 pb-3 mb-3 flex flex-col md:flex-row md:items-start md:justify-between gap-2",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"pt-1",children:e.jsx("input",{type:"checkbox",className:"h-5 w-5 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded cursor-pointer",checked:o,onChange:()=>B(t.id)})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("span",{className:"font-bold text-gray-900 text-lg",children:new Date(t.date).toLocaleDateString()}),t.reference&&e.jsxs("span",{className:"text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded-md font-mono border border-gray-200",children:["Ref: ",t.reference]}),e.jsx("span",{className:"text-xs bg-indigo-50 text-indigo-700 px-2 py-1 rounded-md border border-indigo-100",children:M(t.branchId)}),t.status&&t.status!=="POSTED"&&e.jsx("span",{className:`text-xs px-2 py-1 rounded-md font-medium ${t.status==="PENDING_APPROVAL"?"bg-yellow-100 text-yellow-800 border border-yellow-200":t.status==="DRAFT"?"bg-gray-100 text-gray-600 border border-gray-200":t.status==="REJECTED"?"bg-red-100 text-red-800 border border-red-200":"bg-green-100 text-green-800 border border-green-200"}`,children:t.status==="PENDING_APPROVAL"?"â³ Pending":t.status==="DRAFT"?"ðŸ“ Draft":t.status==="REJECTED"?"âŒ Rejected":t.status}),e.jsx("span",{className:"text-xs text-gray-400 font-mono",title:"System ID",children:t.id})]}),e.jsx("p",{className:"text-gray-800 mt-2 font-medium",children:t.description}),t.createdByName&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Created by: ",e.jsx("span",{className:"font-medium",children:t.createdByName})]}),t.status==="REJECTED"&&t.rejectionReason&&e.jsxs("div",{className:"mt-2 bg-red-50 border border-red-200 rounded-lg p-2",children:[e.jsxs("p",{className:"text-xs text-red-700",children:[e.jsx("strong",{children:"Rejection Reason:"})," ",t.rejectionReason]}),t.approvedByName&&e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Rejected by: ",t.approvedByName]})]}),S&&e.jsxs("div",{className:"mt-1 text-xs font-medium text-blue-700 bg-blue-50 inline-block px-2 py-0.5 rounded border border-blue-100",children:["Global Rate: ",t.currency," @ ",t.exchangeRate]})]})]}),e.jsxs("div",{className:"flex flex-col items-end space-y-2 pl-8 md:pl-0",children:[R&&t.status==="PENDING_APPROVAL"&&t.createdBy!==k&&l&&f&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>l(t.id),disabled:g,className:"text-xs px-3 py-1.5 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 flex items-center",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),"Approve"]}),e.jsxs("button",{onClick:()=>f(t.id,t.description),disabled:g,className:"text-xs px-3 py-1.5 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 disabled:opacity-50 flex items-center",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),"Reject"]})]}),R&&t.status==="PENDING_APPROVAL"&&t.createdBy===k&&e.jsx("span",{className:"text-xs text-gray-500 italic",children:"Cannot approve own entry"}),I&&!t.relatedDocumentId&&e.jsx(U,{variant:"outline",className:"text-xs px-3 py-1 h-8",onClick:()=>I(t),children:"Edit Entry"}),t.relatedDocumentId&&e.jsx("div",{className:"flex items-center gap-1",children:w&&(t.relatedDocumentId.startsWith("inv-")||t.relatedDocumentId.startsWith("bill-")||t.relatedDocumentId.startsWith("loan-"))?e.jsxs("button",{onClick:()=>w&&w(t.relatedDocumentId),className:"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded border border-blue-100 flex items-center hover:bg-blue-100 hover:border-blue-300 transition-colors",title:"View Related Record",children:[e.jsxs("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Link: ",t.relatedDocumentId]}):e.jsxs("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded border border-gray-200 flex items-center font-mono",title:`Linked Document: ${t.relatedDocumentId}`,children:[e.jsx("svg",{className:"w-3 h-3 mr-1 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),"Ref: ",t.relatedDocumentId]})}),t.attachment&&e.jsxs("button",{onClick:()=>y(t.attachment||null),className:"text-xs text-indigo-600 bg-indigo-50 px-2 py-1 rounded border border-indigo-100 flex items-center hover:bg-indigo-100 transition-colors",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),"View Attachment"]})]})]}),e.jsx("div",{className:"overflow-x-auto pl-8 md:pl-0",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-gray-500 border-b border-gray-100 bg-gray-50/50 text-xs uppercase",children:[e.jsx("th",{className:"text-left font-semibold py-2 pl-2 w-1/4",children:"Account"}),e.jsx("th",{className:"text-left font-semibold py-2 w-1/4",children:"Description"}),e.jsx("th",{className:"text-right font-semibold py-2 w-1/6",children:"Trans. Amt (FCY)"}),e.jsx("th",{className:"text-right font-semibold py-2",children:"Debit (LCY)"}),e.jsx("th",{className:"text-right font-semibold py-2 pr-2",children:"Credit (LCY)"})]})}),e.jsxs("tbody",{children:[t.lines.map((a,A)=>{const _=a.originalCurrency&&a.originalCurrency!=="USD",H=S||_,G=a.originalDebit>0?a.originalDebit:a.originalCredit>0?a.originalCredit:0,$=a.originalExchangeRate||t.exchangeRate;return e.jsxs("tr",{className:"border-b border-gray-50 last:border-0 hover:bg-gray-50/50 transition-colors",children:[e.jsx("td",{className:"py-2 pl-2 text-gray-700 font-mono align-top",children:O(a.accountId)}),e.jsx("td",{className:"py-2 text-gray-500 italic truncate max-w-xs align-top",title:a.description,children:a.description||"-"}),e.jsx("td",{className:"py-2 text-right text-gray-600 align-top",children:H&&G>0&&e.jsxs("div",{children:[e.jsxs("span",{className:"font-bold text-blue-700",children:[G.toLocaleString()," ",a.originalCurrency||t.currency]}),e.jsxs("div",{className:"text-[9px] text-gray-400",children:["@ ",$]})]})}),e.jsx("td",{className:"py-2 text-right text-gray-800 align-top font-medium",children:a.debit>0?a.debit.toLocaleString("en-US",{minimumFractionDigits:2}):""}),e.jsx("td",{className:"py-2 pr-2 text-right text-gray-800 align-top font-medium",children:a.credit>0?a.credit.toLocaleString("en-US",{minimumFractionDigits:2}):""})]},A)}),e.jsxs("tr",{className:"bg-gray-50 font-semibold",children:[e.jsx("td",{className:"py-2 pl-2 text-gray-500 text-xs uppercase tracking-wider",children:"Totals (Base)"}),e.jsx("td",{colSpan:2}),e.jsx("td",{className:"py-2 text-right text-indigo-700",children:t.lines.reduce((a,A)=>a+A.debit,0).toLocaleString("en-US",{minimumFractionDigits:2})}),e.jsx("td",{className:"py-2 pr-2 text-right text-indigo-700",children:t.lines.reduce((a,A)=>a+A.credit,0).toLocaleString("en-US",{minimumFractionDigits:2})})]})]})]})})]},t.id)}),m.length===0&&e.jsxs("div",{className:"text-center py-16 text-gray-500 bg-white rounded-xl border border-dashed border-gray-300",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No transactions found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Try adjusting your search terms or create a new journal entry."})]})]}),n.size>0&&e.jsxs("div",{className:"fixed bottom-6 left-1/2 transform -translate-x-1/2 bg-gray-900 text-white px-6 py-3 rounded-full shadow-2xl z-50 flex items-center gap-6 animate-fade-in-up max-w-[90vw]",children:[e.jsxs("span",{className:"font-bold text-sm whitespace-nowrap",children:[n.size," Selected"]}),e.jsx("div",{className:"h-4 w-px bg-gray-700"}),e.jsxs("div",{className:"flex gap-3",children:[r&&e.jsxs("button",{onClick:E,disabled:x,className:"text-sm font-medium hover:text-indigo-300 transition-colors flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reverse"]}),d&&e.jsxs("button",{onClick:J,disabled:x,className:"text-sm font-medium text-red-400 hover:text-red-300 transition-colors flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete"]})]}),e.jsx("div",{className:"h-4 w-px bg-gray-700"}),e.jsx("button",{onClick:()=>c(new Set),className:"text-gray-400 hover:text-white transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),N&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-75 backdrop-blur-sm p-4",onClick:()=>y(null),children:e.jsxs("div",{className:"bg-white p-4 rounded-xl max-w-3xl w-full flex flex-col items-center max-h-[90vh] overflow-y-auto",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between w-full mb-4 border-b pb-2",children:[e.jsx("h3",{className:"text-lg font-bold",children:"Attachment"}),e.jsx("button",{onClick:()=>y(null),className:"text-gray-500 hover:text-gray-700",children:"Close"})]}),e.jsx("img",{src:N,alt:"Document Attachment",className:"w-full h-auto rounded-lg border border-gray-200"}),e.jsx("div",{className:"mt-4 w-full flex justify-end",children:e.jsx(U,{onClick:()=>window.open(N,"_blank"),children:"Open Full Size"})})]})}),L&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm p-6 animate-fade-in-up",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"bg-red-100 p-3 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 text-center mb-2",children:"Delete Transactions?"}),e.jsxs("p",{className:"text-center text-gray-600 mb-6 text-sm",children:["Are you sure you want to delete ",e.jsxs("strong",{children:[n.size," transaction(s)"]}),"? This action cannot be undone."]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>C(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:W,disabled:x,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-xl hover:bg-red-700 disabled:opacity-50",children:x?"Deleting...":"Delete"})]})]})}),F&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-sm p-6 animate-fade-in-up",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"bg-yellow-100 p-3 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 text-center mb-2",children:"Reverse Transactions?"}),e.jsxs("p",{className:"text-center text-gray-600 mb-6 text-sm",children:["Are you sure you want to reverse ",e.jsxs("strong",{children:[n.size," transaction(s)"]}),"? This will create offsetting entries."]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>D(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:s,disabled:x,className:"flex-1 px-4 py-2 bg-yellow-600 text-white rounded-xl hover:bg-yellow-700 disabled:opacity-50",children:x?"Reversing...":"Reverse"})]})]})})]})};function le(){const{transactions:h,accounts:T,branches:P,currencies:I,refreshData:d}=Y(),{user:r}=Q(),w=V("CREATE_JOURNAL"),R=V("APPROVE_JOURNAL"),[l,f]=i.useState("POSTED"),[k,g]=i.useState(void 0),[p,j]=i.useState(!1),[n,c]=i.useState(null),[x,b]=i.useState(""),[N,y]=i.useState(!1),L=i.useMemo(()=>h.filter(s=>{const t=s.status||"POSTED";switch(l){case"POSTED":return t==="POSTED"||!s.status;case"PENDING":return t==="PENDING_APPROVAL";case"DRAFTS":return t==="DRAFT"&&s.createdBy===(r==null?void 0:r.uid);case"REJECTED":return t==="REJECTED";default:return!0}}),[h,l,r==null?void 0:r.uid]),C=h.filter(s=>s.status==="PENDING_APPROVAL").length,F=h.filter(s=>s.status==="DRAFT"&&s.createdBy===(r==null?void 0:r.uid)).length,D=h.filter(s=>s.status==="REJECTED").length,O=async s=>{r&&(k?k.status==="REJECTED"?(await v.submitForApproval(s,r.uid,r.name),u.success("Entry resubmitted for approval")):(await v.updateTransaction(s),u.success("Entry updated")):(await v.submitForApproval(s,r.uid,r.name),u.success("Entry submitted for approval")),await d(),j(!1),g(void 0))},M=async s=>{r&&(await v.saveAsDraft(s,r.uid,r.name),u.success("Entry saved as draft"),await d(),j(!1),g(void 0))},m=async s=>{if(r){y(!0);try{await v.approveJournalEntry(s,r.uid,r.name),u.success("Entry approved and posted"),await d()}catch(t){u.error(`Failed to approve: ${t.message}`)}finally{y(!1)}}},B=async()=>{if(!(!r||!n)){if(!x.trim()){u.error("Please provide a rejection reason");return}y(!0);try{await v.rejectJournalEntry(n.id,x,r.uid,r.name),u.success("Entry rejected"),c(null),b(""),await d()}catch(s){u.error(`Failed to reject: ${s.message}`)}finally{y(!1)}}},z=s=>{g(s),j(!0)},J=async s=>{await v.deleteTransactions(s),await d()},W=()=>{g(void 0),j(!0)},E=s=>`px-4 py-2 rounded-lg text-sm font-medium transition-colors ${l===s?"bg-indigo-50 text-indigo-700":"text-gray-600 hover:bg-gray-50"}`;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"General Journal"}),w&&!p&&e.jsx("button",{onClick:W,className:"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700",children:"+ New Entry"})]}),p?e.jsx("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 p-6",children:e.jsx(K,{accounts:T,branches:P,currencies:I,initialData:k,onSubmit:O,onSaveDraft:M,onCancel:()=>{j(!1),g(void 0)}})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex space-x-1 bg-white p-1 rounded-xl shadow-sm border border-gray-100 max-w-fit mb-6",children:[e.jsx("button",{onClick:()=>f("POSTED"),className:E("POSTED"),children:"Posted"}),e.jsxs("button",{onClick:()=>f("PENDING"),className:E("PENDING"),children:["Pending Approval",C>0&&e.jsx("span",{className:"ml-2 bg-yellow-100 text-yellow-800 text-xs px-2 py-0.5 rounded-full",children:C})]}),w&&e.jsxs("button",{onClick:()=>f("DRAFTS"),className:E("DRAFTS"),children:["My Drafts",F>0&&e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-600 text-xs px-2 py-0.5 rounded-full",children:F})]}),D>0&&e.jsxs("button",{onClick:()=>f("REJECTED"),className:E("REJECTED"),children:["Rejected",e.jsx("span",{className:"ml-2 bg-red-100 text-red-800 text-xs px-2 py-0.5 rounded-full",children:D})]})]}),l==="PENDING"&&R&&L.length>0&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-4 mb-4",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Approval Queue:"})," Review entries below. You cannot approve your own entries."]})}),e.jsx(X,{transactions:L,accounts:T,branches:P,onEdit:z,onDeleteBatch:J,onViewRelated:s=>u.info("Navigate to source module: "+s),showApprovalActions:l==="PENDING"&&R,onApprove:m,onReject:(s,t)=>c({id:s,description:t}),currentUserId:r==null?void 0:r.uid,isProcessing:N}),L.length===0&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[l==="PENDING"&&"No entries pending approval",l==="DRAFTS"&&"No draft entries",l==="REJECTED"&&"No rejected entries",l==="POSTED"&&"No posted entries"]})]}),n&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md p-6",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"Reject Entry"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Rejecting: ",e.jsx("strong",{children:n.description})]}),e.jsx("textarea",{className:"w-full border border-gray-300 rounded-xl p-3 text-sm focus:ring-2 focus:ring-red-500 focus:border-red-500",rows:3,placeholder:"Enter rejection reason...",value:x,onChange:s=>b(s.target.value)}),e.jsxs("div",{className:"flex space-x-3 mt-4",children:[e.jsx("button",{onClick:()=>{c(null),b("")},className:"flex-1 px-4 py-2 border border-gray-300 rounded-xl text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:B,disabled:N,className:"flex-1 px-4 py-2 bg-red-600 text-white rounded-xl hover:bg-red-700 disabled:opacity-50",children:N?"Rejecting...":"Reject"})]})]})})]})}export{le as default};
