import{r as a,j as s,f as m}from"./index-BUL6LB55.js";const k=({value:f,onChange:d,onSelect:g,onPickMap:c,placeholder:x="Search places...",className:v=""})=>{const[o,l]=a.useState([]),[y,t]=a.useState(!1),[p,u]=a.useState(!1),i=a.useRef(null);a.useEffect(()=>{const e=r=>{i.current&&!i.current.contains(r.target)&&t(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const b=async e=>{if(d(e),!e||e.length<2){l([]),t(!1);return}u(!0);try{let r=await m.placeService.searchPlaces(e);if(!r||Array.isArray(r)&&r.length===0){const w=await m.placeService.getAllPlaces(),h=e.toLowerCase().trim();r=w.filter(n=>{const L=n.name&&n.name.toLowerCase().includes(h),N=n.address&&n.address.toLowerCase().includes(h);return L||N}).slice(0,10)}l(Array.isArray(r)?r:[]),t(!0)}catch(r){console.error("Search failed",r),l([])}finally{u(!1)}},j=e=>{d(e.address||e.name),g(e),t(!1)};return s.jsxs("div",{className:"relative",ref:i,children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx("input",{type:"text",className:v,value:f,onChange:e=>b(e.target.value),placeholder:x,onFocus:()=>{o.length>0&&t(!0)}}),p&&s.jsx("div",{className:"absolute right-3 top-3",children:s.jsx("div",{className:"w-4 h-4 border-2 border-indigo-600 border-t-transparent rounded-full animate-spin"})})]}),c&&s.jsx("button",{type:"button",onClick:c,className:"px-3 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg text-gray-600 transition-colors",title:"Pick on Map",children:s.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),y&&o.length>0&&s.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:o.map(e=>s.jsxs("div",{className:"px-4 py-3 hover:bg-gray-50 cursor-pointer border-b border-gray-50 last:border-none",onClick:()=>j(e),children:[s.jsx("div",{className:"font-medium text-sm text-gray-900",children:e.name}),s.jsx("div",{className:"text-xs text-gray-500 truncate",children:e.address})]},e.id))})]})};export{k as P};
