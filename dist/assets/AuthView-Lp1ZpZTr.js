import{a as g,b as f,B as p,r,j as R,f as i,C as I}from"./index-BUL6LB55.js";import{AuthForms as S}from"./AuthForms-DKiK7dhL.js";import"./Button-CqEssTF4.js";import"./errorUtils-CUS756ws.js";function T(){const t=g(),{user:l,loading:c}=f(),{mode:o}=p(),[s,n]=r.useState(o==="register"?"REGISTER":o==="reset"?"RESET":o==="verify"?"VERIFY":"LOGIN");r.useEffect(()=>{!c&&l&&t("/app",{replace:!0})},[l,c,t]),r.useEffect(()=>{(async()=>{i.isEmailLink(window.location.href)&&n("VERIFY")})()},[]);const E=async e=>{if(s==="LOGIN")await i.login(e.email,e.password);else if(s==="REGISTER")await i.sendRegistrationLink(e.email,e),n("EMAIL_SENT");else if(s==="VERIFY"){const a=window.localStorage.getItem("registration_email")||"";await i.completeRegistrationWithLink(a,e.password)}else if(s==="RESET"){if(!e.email.includes("@")&&e.email.length>=8){t(`/auth/reset/phone?phone=${encodeURIComponent(e.email)}`);return}await i.resetPassword(e.email)}},m=async e=>{await i.signInWithGoogle(I,e)},h=e=>{n(e),(e==="LOGIN"||e==="REGISTER"||e==="RESET")&&t(e==="REGISTER"?"/auth/register":e==="RESET"?"/auth/reset":"/auth/login",{replace:!0})},u=()=>{t("/landing")};return R.jsx(S,{mode:s,onSubmit:E,onModeChange:h,onBack:u,onGoogleSignIn:m})}export{T as default};
