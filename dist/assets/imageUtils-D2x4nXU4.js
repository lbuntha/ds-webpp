const p=(c,h=400)=>new Promise((w,i)=>{const l=new FileReader;l.readAsDataURL(c),l.onload=m=>{var d;const a=new Image;a.src=(d=m.target)==null?void 0:d.result,a.onload=()=>{const r=document.createElement("canvas");let e=a.width,t=a.height;const o=1280;e>t?e>o&&(t*=o/e,e=o):t>o&&(e*=o/t,t=o),r.width=e,r.height=t;const g=r.getContext("2d");if(!g){i(new Error("Could not get canvas context"));return}g.drawImage(a,0,0,e,t);let n=.9,s=r.toDataURL("image/jpeg",n);for(;s.length>h*1024&&n>.1;)n-=.1,s=r.toDataURL("image/jpeg",n);w(s)},a.onerror=()=>i(new Error("Failed to load image for processing"))},l.onerror=()=>i(new Error("Failed to read file"))});export{p};
