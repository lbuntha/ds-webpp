import{a as v,c as y,r,j as e,v as k,d as u,e as P}from"./index-BjK2osQV.js";import{B as m}from"./Button-JCYNVMjR.js";function S(){const d=v(),[w]=y(),[o,n]=r.useState("LOADING"),[f,p]=r.useState(""),[t,j]=r.useState(""),[c,g]=r.useState(""),[b,h]=r.useState(!1),[x,s]=r.useState(null),i=w.get("oobCode");r.useEffect(()=>{(async()=>{if(!i){s("Invalid or missing reset code. Please request a new password reset."),n("ERROR");return}try{const l=await k(u,i);p(l),n("NEW_PASSWORD")}catch(l){console.error("Verify code error:",l),l.code==="auth/expired-action-code"?s("This password reset link has expired. Please request a new one."):l.code==="auth/invalid-action-code"?s("This password reset link is invalid or has already been used."):s("Failed to verify reset link. Please try again."),n("ERROR")}})()},[i]);const N=async()=>{if(!t||t.length<6){s("Password must be at least 6 characters");return}if(t!==c){s("Passwords do not match");return}h(!0),s(null);try{await P(u,i,t),n("SUCCESS")}catch(a){console.error("Reset password error:",a),a.code==="auth/weak-password"?s("Password is too weak. Please choose a stronger password."):a.code==="auth/expired-action-code"?s("This reset link has expired. Please request a new one."):s("Failed to reset password. Please try again.")}finally{h(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-row bg-white",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-5/12 bg-slate-900 relative overflow-hidden flex-col justify-between p-12 text-white",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-10",children:[e.jsx("img",{src:"/logo/icon.png",alt:"Doorstep",className:"h-8 w-8 object-contain"}),e.jsx("span",{className:"text-2xl font-bold tracking-tight text-white drop-shadow-sm",children:"Doorstep"})]}),e.jsx("h1",{className:"text-4xl font-extrabold leading-tight mb-6",children:"Reset Your Password"}),e.jsx("p",{className:"text-slate-400 text-lg leading-relaxed max-w-md",children:"Create a strong, memorable password to secure your account."})]}),e.jsx("div",{className:"absolute -bottom-20 -right-20 w-80 h-80 bg-blue-600/10 rounded-full blur-3xl"})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("button",{onClick:()=>d("/auth/login"),className:"flex items-center gap-2 text-slate-500 hover:text-slate-700 mb-8 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Login"]}),e.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-sm border border-gray-100",children:[o==="LOADING"&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-red-600 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"Verifying reset link..."})]}),o==="ERROR"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Link Invalid"}),e.jsx("p",{className:"text-slate-600 mb-8",children:x}),e.jsx(m,{onClick:()=>d("/auth/reset"),className:"w-full",children:"Request New Reset Link"})]}),o==="SUCCESS"&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Password Reset!"}),e.jsx("p",{className:"text-slate-600 mb-8",children:"Your password has been successfully updated. You can now log in with your new password."}),e.jsx(m,{onClick:()=>d("/auth/login"),className:"w-full",children:"Go to Login"})]}),o==="NEW_PASSWORD"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-3xl",children:"ðŸ”"})})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:"Create New Password"}),e.jsxs("p",{className:"mt-2 text-sm text-slate-600",children:["for ",e.jsx("span",{className:"font-medium text-slate-800",children:f})]})]}),x&&e.jsx("div",{className:"mb-6 p-4 rounded-lg bg-red-50 border border-red-200 text-red-700 text-sm",children:x}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"New Password"}),e.jsx("input",{type:"password",value:t,onChange:a=>j(a.target.value),placeholder:"Enter new password",className:"w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-red-500 focus:ring-2 focus:ring-red-200 transition-all",autoFocus:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Confirm Password"}),e.jsx("input",{type:"password",value:c,onChange:a=>g(a.target.value),placeholder:"Confirm new password",className:"w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-red-500 focus:ring-2 focus:ring-red-200 transition-all"})]}),e.jsx(m,{onClick:N,isLoading:b,className:"w-full py-3",children:"Reset Password"})]}),e.jsxs("div",{className:"mt-6 p-4 bg-slate-50 rounded-lg",children:[e.jsx("p",{className:"text-xs font-medium text-slate-500 mb-2",children:"Password Requirements:"}),e.jsxs("ul",{className:"text-xs text-slate-500 space-y-1",children:[e.jsx("li",{className:t.length>=6?"text-green-600":"",children:"â€¢ At least 6 characters"}),e.jsx("li",{className:t===c&&t.length>0?"text-green-600":"",children:"â€¢ Passwords must match"})]})]})]})]})]})})]})}export{S as default};
