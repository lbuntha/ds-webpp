const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/glBookingService-DfpBjfXH.js","assets/index-BjK2osQV.js","assets/index-CY9_X8xj.css"])))=>i.map(i=>d[i]);
import{r as h,j as e,f as L,k as X,l as ee,_ as xe}from"./index-BjK2osQV.js";import{B as _}from"./Button-JCYNVMjR.js";const ve=({transaction:r,onClose:R,onConfirm:H,isApproving:C,bookings:S=[],commissionRules:j=[],employees:y=[],accounts:b=[],settings:m={},currencies:K=[],taxRates:ue=[]})=>{var W,J,Q;const[g,V]=h.useState([]),[he,P]=h.useState(!0),[I,te]=h.useState(null),[O,re]=h.useState([]),[$,se]=h.useState(""),N=h.useMemo(()=>!r.bankAccountId||!b?null:b.find(t=>t.id===r.bankAccountId)||b.find(t=>t.code===r.bankAccountId),[r.bankAccountId,b]),z=t=>{const i=b.find(c=>c.id===t);return i?`${i.code} - ${i.name}`:t};h.useEffect(()=>{(async()=>{P(!0);try{if(r.journalEntryId){const x=await L.getDocument("transactions",r.journalEntryId);te(x)}if(r.userId)try{const l=(await L.getCustomers()).filter(d=>d.linkedUserId===r.userId);let o=[];l.forEach(d=>{const s=d;if(d.bankAccounts&&d.bankAccounts.length>0&&(o=[...o,...d.bankAccounts]),s.bank_account){if(s.bank_account.usd){const a=s.bank_account.usd;o.push({bankName:a.bank_name?`${a.bank_name} (USD)`:"USD Account",accountNumber:a.account_number,accountName:d.name,qrCode:a.qr_code_url,id:"usd-main"})}if(s.bank_account.khr){const a=s.bank_account.khr;o.push({bankName:a.bank_name?`${a.bank_name} (KHR)`:"KHR Account",accountNumber:a.account_number,accountName:d.name,qrCode:a.qr_code_url,id:"khr-main"})}}o.length===0&&d.bankName&&d.bankAccountNumber&&o.push({bankName:d.bankName,accountNumber:d.bankAccountNumber,accountName:d.name,id:"legacy"})});const n=o.filter((d,s,a)=>a.findIndex(u=>u.accountNumber===d.accountNumber)===s);n.length>0&&re(n)}catch{}if(!r.relatedItems||r.relatedItems.length===0){V([{id:r.id,date:r.date,reference:(r.id||"").slice(-6),description:r.description||r.type,amount:r.amount,currency:r.currency,status:r.status,details:{type:"DIRECT"}}]),P(!1);return}const i=r.relatedItems[0],c=[];if(i.itemId==="invoice"){const x=await L.getInvoices(),l=r.relatedItems.map(n=>n.bookingId);x.filter(n=>l.includes(n.id)).forEach(n=>{c.push({id:n.id,date:n.date,reference:n.number,description:"Invoice Payment",amount:n.totalAmount-n.amountPaid,currency:n.currency||"USD",status:n.status,details:{receiver:n.customerName,type:"INVOICE"}})})}else{let x=S;x.length===0&&(x=await L.getParcelBookings());const l=y.find(o=>o.linkedUserId===r.userId);for(const o of r.relatedItems){const n=x.find(d=>d.id===o.bookingId);if(n){const d=n.items||[],s=d.find(a=>a.id===o.itemId);if(s){const a=r.currency||"USD",u=4e3,A=d.length>0?d.length:1,Y=a==="KHR"?s.deliveryFeeKHR??s.deliveryFee??(n.totalDeliveryFee||0)/A:s.deliveryFeeUSD??s.deliveryFee??(n.totalDeliveryFee||0)/A,U=a,de=(p,f)=>f===a?p:f==="USD"&&a==="KHR"?p*u:f==="KHR"&&a==="USD"?p/u:p,Z=s.modifications||[],T=Z.find(p=>p.newValue==="PICKED_UP"),ce=(T==null?void 0:T.userName)||n.driverName||"Unknown",B=Z.find(p=>p.newValue==="DELIVERED"||p.newValue==="RETURN_TO_SENDER"),le=(B==null?void 0:B.userName)||(s.status!=="PENDING"?s.driverName:"Unknown"),ge=X(l,"PICKUP",j);let w=ee(l,n,"PICKUP",j,Y,a,u),F=w;const be=X(l,"DELIVERY",j);let D=ee(l,n,"DELIVERY",j,Y,a,u),M=D;if(w=Math.round((w+Number.EPSILON)*100)/100,D=Math.round((D+Number.EPSILON)*100)/100,F=Math.round((F+Number.EPSILON)*100)/100,M=Math.round((M+Number.EPSILON)*100)/100,w>0&&U===a&&c.push({id:`${s.id}-pickup`,date:n.bookingDate,reference:s.trackingCode||"N/A",description:`Pickup (by ${ce})`,amount:0,currency:s.codCurrency||"USD",status:s.settlementStatus||"UNSETTLED",commission:w,commissionCurrency:a,originalCommission:F,originalCommissionCurrency:U,details:{sender:n.senderName||"Unknown Sender",receiver:s.receiverName||"Unknown Receiver",type:"PARCEL"}}),D>0&&U===a&&c.push({id:`${s.id}-delivery`,date:n.bookingDate,reference:s.trackingCode||"N/A",description:`Delivery (by ${le})`,amount:s.productPrice||0,currency:s.codCurrency||"USD",status:s.settlementStatus||"UNSETTLED",commission:D,commissionCurrency:a,originalCommission:M,originalCommissionCurrency:U,details:{sender:n.senderName||"Unknown Sender",receiver:s.receiverName||"Unknown Receiver",type:"PARCEL"}}),(s.taxiFee||0)>0){const p=Number(s.taxiFee),f=s.taxiFeeCurrency||a;if(f===a){const me=de(p,f);c.push({id:`${s.id}-taxi`,date:n.bookingDate,reference:s.trackingCode||"N/A",description:"Taxi Fee (Paid by Driver)",amount:-me,currency:a,status:"SETTLED",commission:0,details:{sender:n.senderName||"Unknown Sender",receiver:s.receiverName||"Unknown Receiver",type:"PARCEL"}})}else c.push({id:`${s.id}-taxi-pending`,date:n.bookingDate,reference:s.trackingCode||"N/A",description:`Taxi Fee (Pending ${f})`,amount:0,currency:a,status:"PENDING",commission:0,originalCommission:-p,originalCommissionCurrency:f,details:{sender:n.senderName||"Unknown Sender",receiver:s.receiverName||"Unknown Receiver",type:"PARCEL"}})}}}}}V(c)}catch{}finally{P(!1)}})()},[r,S]);const[v,ne]=h.useState(null),[pe,q]=h.useState(!1);h.useEffect(()=>{if(!C||I||!m||b.length===0)return;(async()=>{q(!0);try{const i={accounts:b,settings:m,employees:y,commissionRules:j,bookings:S,currencies:K},c="b1",l=(r.currency||"USD").toUpperCase()==="USD";let o=r.bankAccountId;const n=m.transactionRules?m.transactionRules[4]:null;if(!o||o==="system"||o==="system-payout"){const u=y.some(A=>A.linkedUserId===r.userId);u?n?o=n:(o=l?m.defaultDriverSettlementBankIdUSD||m.defaultDriverSettlementBankId:m.defaultDriverSettlementBankIdKHR||m.defaultDriverSettlementBankId,o||(o=l?m.defaultDriverCashAccountIdUSD:m.defaultDriverCashAccountIdKHR)):(o=l?m.defaultCustomerSettlementBankIdUSD||m.defaultCustomerSettlementBankId:m.defaultCustomerSettlementBankIdKHR||m.defaultCustomerSettlementBankId,o||(o=l?m.defaultDriverCashAccountIdUSD:m.defaultDriverCashAccountIdKHR)),console.log("DEBUG: Resolved Preview Bank ID:",o,{isDriver:u,isUSD:l}),console.log("DEBUG: Settings Snap:",{custUSD:m.defaultCustomerSettlementBankIdUSD,custKHR:m.defaultCustomerSettlementBankIdKHR,drvCashUSD:m.defaultDriverCashAccountIdUSD,drvCashKHR:m.defaultDriverCashAccountIdKHR})}const{GLBookingService:d}=await xe(async()=>{const{GLBookingService:u}=await import("./glBookingService-DfpBjfXH.js");return{GLBookingService:u}},__vite__mapDeps([0,1,2])),s={transactionType:r.type,userId:r.userId,userName:r.userName,userRole:y.some(u=>u.linkedUserId===r.userId)?"driver":"customer",amount:r.amount,currency:r.currency,relatedItems:r.relatedItems,bankAccountId:o||"",description:r.description,branchId:c},a=await d.previewGLEntry(s,i);ne(a)}catch{}finally{q(!1)}})()},[C,I,r,m,b,K,y,S,j]);const k=((W=v==null?void 0:v.lines)==null?void 0:W.map(t=>({accountName:z(t.accountId),accountCode:"",debit:t.debit,credit:t.credit,description:t.description,isError:!1})))||[];((J=v==null?void 0:v.errors)==null?void 0:J.length)>0&&v.errors.forEach(t=>{k.push({accountName:"CONFIGURATION ERROR",accountCode:"ERR",debit:0,credit:0,description:t,isError:!0})});const ae=h.useMemo(()=>g.reduce((t,i)=>t+i.amount,0),[g]),ie=h.useMemo(()=>g.reduce((t,i)=>t+(i.commission||0),0),[g]),E=h.useMemo(()=>y.find(t=>t.linkedUserId===r.userId),[y,r.userId]),oe=()=>{const t=document.getElementById("settlement-report-content");if(t){const i=document.body.innerHTML;document.body.innerHTML=t.innerHTML,window.print(),document.body.innerHTML=i,window.location.reload()}},G=k==null?void 0:k.some(t=>t.isError);return e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-gray-900 bg-opacity-75 backdrop-blur-sm p-4",onClick:R,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl overflow-hidden flex flex-col max-h-[90vh]",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-b border-gray-200 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Transaction Detail"}),e.jsxs("p",{className:"text-xs text-gray-500 font-mono",children:["Ref: ",r.id]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"outline",onClick:oe,className:"text-xs",children:"Print / PDF"}),e.jsx("button",{onClick:R,className:"text-gray-400 hover:text-gray-600 p-2",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsxs("div",{id:"settlement-report-content",className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"mb-6 flex justify-between items-start border-b border-gray-100 pb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold",children:"User"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:r.userName}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",r.userId]}),(E==null?void 0:E.zone)&&e.jsx("p",{className:"text-xs text-purple-600 font-medium mt-1",children:e.jsxs("span",{className:"bg-purple-100 px-2 py-0.5 rounded",children:["Zone: ",E.zone]})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xs text-gray-500 uppercase font-bold",children:["Total ",r.type]}),e.jsxs("p",{className:"text-2xl font-bold text-green-700",children:[r.amount.toLocaleString()," ",r.currency]}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(r.date).toLocaleDateString()})]})]}),(()=>{const t=r.attachments||[],i=r.attachment||"";let c=[...t];if(i){const x=i.split(",").map(l=>l.trim()).filter(Boolean);c=[...c,...x]}return c=Array.from(new Set(c)),c.length===0?null:e.jsxs("div",{className:"mb-6",children:[e.jsxs("p",{className:"text-xs text-gray-500 uppercase font-bold mb-2",children:["Proof of Transfer (",c.length,")"]}),e.jsx("div",{className:`grid ${c.length>1?"grid-cols-2":"grid-cols-1"} gap-2`,children:c.map((x,l)=>e.jsxs("div",{className:"h-48 w-full bg-gray-50 rounded-lg border border-gray-200 flex items-center justify-center overflow-hidden relative group",children:[e.jsx("img",{src:x,alt:`Transfer Proof ${l+1}`,className:"h-full object-contain cursor-pointer",onClick:()=>window.open(x,"_blank")}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all flex items-center justify-center pointer-events-none",children:e.jsx("span",{className:"opacity-0 group-hover:opacity-100 bg-white text-xs px-2 py-1 rounded shadow pointer-events-auto",children:"View"})})]},l))})]})})(),N&&e.jsx("div",{className:"mb-6 bg-blue-50 p-4 rounded-lg border border-blue-100",children:e.jsxs("div",{className:"flex items-start gap-4",children:[N.qrCode&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:N.qrCode,alt:"Payment QR Code",className:"w-24 h-24 object-contain bg-white p-1 rounded-lg border border-gray-200"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-white rounded-full text-blue-600",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 14v3m4-3v3m4-3v3M3 21h18M3 10h18M3 7l9-4 9 4M4 10h16v11H4V10z"})})}),e.jsx("p",{className:"text-xs text-blue-800 font-bold uppercase",children:"Settlement Account"})]}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:N.name}),e.jsx("p",{className:"text-sm text-gray-600 font-mono",children:N.code}),N.bankAccountNumber&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-blue-200",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Account Number"}),e.jsx("p",{className:"text-base font-mono font-bold text-gray-900 tracking-wider",children:N.bankAccountNumber})]})]})]})}),O.length>0&&e.jsx("div",{className:"mb-6 space-y-4",children:O.map((t,i)=>e.jsx("div",{className:"bg-green-50 p-4 rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex items-start gap-4",children:[t.qrCode&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:t.qrCode,alt:"Customer QR Code",className:"w-24 h-24 object-contain bg-white p-1 rounded-lg border border-gray-200"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"p-2 bg-white rounded-full text-green-600",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsxs("p",{className:"text-xs text-green-800 font-bold uppercase",children:["Pay To Customer (",t.bankName,")"]})]}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t.bankName}),t.accountName&&e.jsx("p",{className:"text-sm text-gray-600",children:t.accountName}),e.jsxs("div",{className:"mt-2 pt-2 border-t border-green-200",children:[e.jsx("p",{className:"text-xs text-gray-500",children:"Account Number"}),e.jsx("p",{className:"text-base font-mono font-bold text-gray-900 tracking-wider",children:t.accountNumber})]})]})]})},i))}),g.length>0?e.jsxs("div",{className:"mb-2",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-800 mb-2",children:"Item Breakdown"}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left text-xs font-bold text-gray-500 uppercase",children:"Item / Ref"}),e.jsx("th",{className:"px-3 py-2 text-left text-xs font-bold text-gray-500 uppercase",children:"Context"}),e.jsx("th",{className:"px-3 py-2 text-right text-xs font-bold text-gray-500 uppercase",children:"Amount"}),r.type==="SETTLEMENT"&&g.some(t=>{var i;return((i=t.details)==null?void 0:i.type)==="PARCEL"})&&e.jsx("th",{className:"px-3 py-2 text-right text-xs font-bold text-gray-500 uppercase",children:"Est. Comm"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-200 bg-white",children:[g.map((t,i)=>{var c,x,l,o,n;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-3 py-2",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.description}),e.jsx("div",{className:"text-xs text-gray-500 font-mono",children:t.reference})]}),e.jsxs("td",{className:"px-3 py-2 text-xs text-gray-600",children:[((c=t.details)==null?void 0:c.type)==="PARCEL"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Sender: ",t.details.sender]}),e.jsxs("div",{children:["To: ",t.details.receiver]})]}),((x=t.details)==null?void 0:x.type)==="INVOICE"&&e.jsxs("div",{children:["Customer: ",t.details.receiver]}),((l=t.details)==null?void 0:l.type)==="DIRECT"&&e.jsx("div",{children:"Direct Transfer"})]}),e.jsxs("td",{className:"px-3 py-2 text-right font-medium text-gray-900",children:[t.amount.toLocaleString()," ",t.currency]}),r.type==="SETTLEMENT"&&t.commission!==void 0&&e.jsx("td",{className:"px-3 py-2 text-right text-xs text-green-600 font-medium",children:t.originalCommissionCurrency&&t.originalCommissionCurrency!==(t.commissionCurrency||"USD")?e.jsxs("div",{children:[(o=t.originalCommission)==null?void 0:o.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," ",t.originalCommissionCurrency]}):e.jsxs("div",{children:[(n=t.commission)==null?void 0:n.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," ",t.commissionCurrency||"USD"]})})]},i)}),g.length>0&&e.jsxs("tr",{className:"bg-gray-100 font-bold border-t-2 border-gray-200",children:[e.jsx("td",{colSpan:2,className:"px-3 py-2 text-right",children:"Totals (Ref)"}),e.jsx("td",{className:"px-3 py-2 text-right",children:ae.toLocaleString()}),r.type==="SETTLEMENT"&&g.some(t=>t.commission)&&e.jsxs("td",{className:"px-3 py-2 text-right text-green-700",children:[ie.toFixed(2)," ",((Q=g[0])==null?void 0:Q.commissionCurrency)||"USD"]})]})]})]})})]}):e.jsx("div",{className:"text-sm text-gray-500 italic mb-4",children:"No breakdown available for this transaction."}),I?e.jsxs("div",{className:"mt-8 border-t border-gray-200 pt-6",children:[e.jsxs("h4",{className:"text-sm font-bold text-gray-800 mb-3 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 01-2-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Accounting Impact (Journal Entry: ",I.reference,")"]}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[e.jsx("thead",{className:"bg-indigo-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left font-bold text-indigo-900",children:"Account"}),e.jsx("th",{className:"px-3 py-2 text-left font-bold text-indigo-900",children:"Description"}),e.jsx("th",{className:"px-3 py-2 text-right font-bold text-indigo-900",children:"Debit (Base)"}),e.jsx("th",{className:"px-3 py-2 text-right font-bold text-indigo-900",children:"Credit (Base)"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:I.lines.map((t,i)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 text-gray-800 font-medium",children:z(t.accountId)}),e.jsx("td",{className:"px-3 py-2 text-gray-500",children:t.description||"-"}),e.jsx("td",{className:"px-3 py-2 text-right text-gray-700",children:t.debit>0?t.debit.toLocaleString("en-US",{minimumFractionDigits:2}):""}),e.jsx("td",{className:"px-3 py-2 text-right text-gray-700",children:t.credit>0?t.credit.toLocaleString("en-US",{minimumFractionDigits:2}):""})]},i))})]})})]}):C&&k?e.jsxs("div",{className:"mt-8 border-t border-gray-200 pt-6",children:[e.jsxs("h4",{className:"text-sm font-bold text-gray-800 mb-3 flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 01-2-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Pending Accounting Entry (Preview)"]}),G&&e.jsxs("div",{className:"mb-3 bg-red-50 border border-red-200 text-red-700 p-3 rounded-lg text-xs flex items-center",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),e.jsxs("span",{children:[e.jsx("strong",{children:"Missing Configuration:"})," Some accounts are not mapped in Settings > General. This transaction cannot be posted correctly until fixed."]})]}),e.jsx("div",{className:"text-xs text-gray-500 mb-2",children:"The following Journal Entry will be created automatically upon approval. Amounts in Base USD."}),e.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-xs",children:[e.jsx("thead",{className:"bg-yellow-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-2 text-left font-bold text-yellow-900",children:"Account"}),e.jsx("th",{className:"px-3 py-2 text-left font-bold text-yellow-900",children:"Description"}),e.jsx("th",{className:"px-3 py-2 text-right font-bold text-yellow-900",children:"Debit (Base)"}),e.jsx("th",{className:"px-3 py-2 text-right font-bold text-yellow-900",children:"Credit (Base)"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:k.map((t,i)=>e.jsxs("tr",{className:t.isError?"bg-red-50":"",children:[e.jsxs("td",{className:`px-3 py-2 font-medium ${t.isError?"text-red-600 font-bold":"text-gray-800"}`,children:[t.accountCode," - ",t.accountName]}),e.jsx("td",{className:"px-3 py-2 text-gray-500",children:t.description||"-"}),e.jsx("td",{className:"px-3 py-2 text-right text-gray-700",children:t.debit>0?t.debit.toLocaleString("en-US",{minimumFractionDigits:2}):""}),e.jsx("td",{className:"px-3 py-2 text-right text-gray-700",children:t.credit>0?t.credit.toLocaleString("en-US",{minimumFractionDigits:2}):""})]},i))})]})})]}):null]}),e.jsxs("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200 flex flex-col space-y-3",children:[C&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1",children:"Approval Note (Optional)"}),e.jsx("textarea",{value:$,onChange:t=>se(t.target.value),placeholder:"Add a note for the customer (e.g., thank you message, discrepancy explanation)...",className:"w-full border border-gray-300 rounded-lg p-2 text-sm focus:ring-2 focus:ring-green-500 focus:border-green-500",rows:2})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx(_,{variant:"outline",onClick:R,children:"Close"}),C&&H&&e.jsx(_,{onClick:()=>H($||void 0),className:"bg-green-600 hover:bg-green-700",disabled:G,children:"Confirm Approval"})]})]})]})})};export{ve as S};
