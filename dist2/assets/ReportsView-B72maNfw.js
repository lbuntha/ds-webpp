import{r as u,j as e,f as U,u as M,A as R,h as O}from"./index-BjK2osQV.js";import{A as G}from"./accountingService-CShnyhxo.js";import{C as $}from"./Card-DROeE3UG.js";import{B as _}from"./Button-JCYNVMjR.js";import{I as q}from"./InTransitAgingReport-D62qE0of.js";import{D as W}from"./DelayedChatReport-VTGKNbPx.js";import"./TrackingTimeline-keA493kc.js";import"./toast-DTXa3ATd.js";const C=p=>Math.round((p+Number.EPSILON)*100)/100,Y=()=>{const[p,S]=u.useState([]),[A,a]=u.useState(!1),[r,I]=u.useState("ALL"),[b,K]=u.useState("");u.useEffect(()=>{(async()=>{a(!0);try{const[c,D,F,f,i]=await Promise.all([U.getUsers(),U.getParcelBookings(),U.walletService.getAllWalletTransactions(),U.logisticsService.getDriverCommissionRules(),U.getEmployees()]),s=T(c,D,F,f,i);S(s)}catch(c){console.error("Failed to load report data",c)}finally{a(!1)}})()},[]);const T=(n,c,D,F,f)=>{const i={};return n.forEach(s=>{(s.role==="customer"||s.role==="driver")&&(i[s.uid]={usd:0,khr:0})}),D.forEach(s=>{if(s.status==="APPROVED"&&i[s.userId]){const o=n.find(d=>d.uid===s.userId);o==null||o.role;const l=(o==null?void 0:o.role)==="driver";if(l&&(!["EARNING","TAXI_FEE"].includes(s.type)||s.type==="TAXI_FEE"&&s.taxiFeeSettled))return;let y=["DEPOSIT","EARNING","REFUND","TAXI_FEE"].includes(s.type);if(s.type==="SETTLEMENT"){if(l)return;y=!1}const k=s.amount;s.currency==="KHR"?i[s.userId].khr=C(i[s.userId].khr+(y?k:-k)):i[s.userId].usd=C(i[s.userId].usd+(y?k:-k))}}),F.find(s=>s.isDefault),c.forEach(s=>{var y,k;if(s.status==="CANCELLED")return;const o=s.items||[],l=s.senderId?(y=n.find(d=>d.linkedCustomerId===s.senderId))==null?void 0:y.uid:(k=n.find(d=>d.name===s.senderName))==null?void 0:k.uid;l&&i[l]&&(o.forEach(d=>{if(d.status==="DELIVERED"){const t=d.productPrice||0;d.codCurrency==="KHR"?i[l].khr=C(i[l].khr+t):i[l].usd=C(i[l].usd+t)}}),o.forEach(d=>{if(d.status==="DELIVERED"){const t=d.codCurrency==="KHR",x=o.length||1;let v=0;if(d.deliveryFeeUSD!==void 0||d.deliveryFeeKHR!==void 0)v=t?d.deliveryFeeKHR||0:d.deliveryFeeUSD||0;else{const L=d.deliveryFee??(s.totalDeliveryFee||0)/x;v=Number(L)||0}t?i[l].khr=C(i[l].khr-v):i[l].usd=C(i[l].usd-v),d.isTaxiDelivery&&d.taxiFee&&d.taxiFee>0&&(d.taxiFeeCurrency==="KHR"?i[l].khr=C(i[l].khr-d.taxiFee):i[l].usd=C(i[l].usd-d.taxiFee))}}))}),n.filter(s=>(s.role==="customer"||s.role==="driver")&&i[s.uid]).map(s=>({uid:s.uid,name:s.name,role:s.role,phone:s.phone,balanceUSD:i[s.uid].usd,balanceKHR:i[s.uid].khr})).sort((s,o)=>o.balanceUSD-s.balanceUSD)},B=u.useMemo(()=>p.filter(n=>{const c=r==="ALL"||n.role===r,D=(n.name||"").toLowerCase().includes(b.toLowerCase());return c&&D}),[p,r,b]),N=u.useMemo(()=>B.reduce((n,c)=>({usd:n.usd+c.balanceUSD,khr:n.khr+c.balanceKHR}),{usd:0,khr:0}),[B]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 print:hidden",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:r==="ALL"?"primary":"outline",onClick:()=>I("ALL"),children:"All"}),e.jsx(_,{variant:r==="customer"?"primary":"outline",onClick:()=>I("customer"),children:"Customers"}),e.jsx(_,{variant:r==="driver"?"primary":"outline",onClick:()=>I("driver"),children:"Drivers"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Search name...",className:"border rounded-lg px-3 py-2 text-sm",value:b,onChange:n=>K(n.target.value)}),e.jsx(_,{variant:"outline",onClick:()=>window.print(),children:"Print"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs($,{className:"bg-indigo-50 border-indigo-200",children:[e.jsx("div",{className:"text-sm font-bold text-indigo-800 uppercase",children:"Total Net Liability (USD)"}),e.jsxs("div",{className:"text-2xl font-bold text-indigo-900 mt-1",children:["$",N.usd.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsx("p",{className:"text-xs text-indigo-600 mt-1",children:N.usd>0?"Company owes Users":"Users owe Company"})]}),e.jsxs($,{className:"bg-teal-50 border-teal-200",children:[e.jsx("div",{className:"text-sm font-bold text-teal-800 uppercase",children:"Total Net Liability (KHR)"}),e.jsxs("div",{className:"text-2xl font-bold text-teal-900 mt-1",children:[N.khr.toLocaleString()," ៛"]})]})]}),e.jsx($,{title:`Wallet Balances (${B.length})`,children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left font-medium text-gray-500 uppercase",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left font-medium text-gray-500 uppercase",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-right font-medium text-gray-500 uppercase",children:"Balance (USD)"}),e.jsx("th",{className:"px-6 py-3 text-right font-medium text-gray-500 uppercase",children:"Balance (KHR)"}),e.jsx("th",{className:"px-6 py-3 text-center font-medium text-gray-500 uppercase",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200 bg-white",children:A?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-10 text-center text-gray-500",children:"Calculating balances..."})}):B.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"px-6 py-10 text-center text-gray-500",children:"No records found."})}):B.map(n=>{let c="text-gray-500 bg-gray-100",D="Balanced";return n.balanceUSD>.01||n.balanceKHR>100?(c="text-green-700 bg-green-100",D="Company Owes User"):(n.balanceUSD<-.01||n.balanceKHR<-100)&&(c="text-red-700 bg-red-100",D="User Owes Company"),e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-gray-900",children:n.name}),e.jsx("div",{className:"text-xs text-gray-500",children:n.phone||"-"})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold uppercase ${n.role==="driver"?"bg-orange-100 text-orange-800":"bg-teal-100 text-teal-800"}`,children:n.role})}),e.jsxs("td",{className:`px-6 py-4 text-right font-bold ${n.balanceUSD<0?"text-red-600":"text-green-600"}`,children:["$",n.balanceUSD.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsxs("td",{className:`px-6 py-4 text-right font-bold ${n.balanceKHR<0?"text-red-600":"text-blue-600"}`,children:[n.balanceKHR.toLocaleString()," ៛"]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-bold uppercase ${c}`,children:D})})]},n.uid)})})]})})})]})},m=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),H=({row:p,val:S})=>e.jsxs("div",{className:"flex justify-between text-sm py-1 border-b border-gray-50 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex items-center",style:{paddingLeft:`${p.depth*1.5}rem`},children:[p.depth>0&&e.jsx("span",{className:"text-gray-300 mr-2",children:"↳"}),e.jsxs("span",{className:p.isHeader?"font-bold text-gray-800":"text-gray-600",children:[p.accountCode," - ",p.accountName]})]}),e.jsx("span",{className:p.isHeader?"font-bold text-gray-800":"text-gray-600",children:S})]}),V=({transactions:p,accounts:S,branches:A})=>{var d;const{t:a}=M(),[r,I]=u.useState("TB"),[b,K]=u.useState(""),[T,B]=u.useState(""),[N,n]=u.useState(()=>{const t=new Date;return new Date(t.getFullYear(),0,1).toISOString().split("T")[0]}),[c,D]=u.useState(()=>new Date().toISOString().split("T")[0]),F=u.useMemo(()=>{let t=b?p.filter(x=>x.branchId===b):p;return r==="IS"?t=t.filter(x=>x.date>=N&&x.date<=c):(r==="TB"||r==="BS")&&(t=t.filter(x=>x.date<=c)),t},[p,b,N,c,r]),f=u.useMemo(()=>G.generateTrialBalance(S,F),[S,F]),i=f.filter(t=>t.depth===0).reduce((t,x)=>t+x.debit,0),s=f.filter(t=>t.depth===0).reduce((t,x)=>t+x.credit,0),o=u.useMemo(()=>{const t=f.filter(h=>h.type===R.REVENUE),x=f.filter(h=>h.type===R.EXPENSE),v=t.filter(h=>h.depth===0).reduce((h,E)=>h+(E.credit-E.debit),0),L=x.filter(h=>h.depth===0).reduce((h,E)=>h+(E.debit-E.credit),0);return{revenue:t,expenses:x,totalRevenue:v,totalExpenses:L,netIncome:v-L}},[f]),l=u.useMemo(()=>{const t=f.filter(g=>g.type===R.ASSET),x=f.filter(g=>g.type===R.LIABILITY),v=f.filter(g=>g.type===R.EQUITY),L=t.filter(g=>g.depth===0).reduce((g,j)=>g+(j.debit-j.credit),0),h=x.filter(g=>g.depth===0).reduce((g,j)=>g+(j.credit-j.debit),0);let E=v.filter(g=>g.depth===0).reduce((g,j)=>g+(j.credit-j.debit),0);return E+=o.netIncome,{assets:t,liabilities:x,equity:v,totalAssets:L,totalLiabilities:h,totalEquity:E,netIncome:o.netIncome}},[f,o]),y=u.useMemo(()=>{if(r!=="GL"||!T)return null;const t=S.find(w=>w.id===T);if(!t)return null;const x=[R.LIABILITY,R.EQUITY,R.REVENUE].includes(t.type);let v=b?p.filter(w=>w.branchId===b):p;const L=G.generateGeneralLedger(T,v),h=L.filter(w=>w.date<N);let E=h.length>0?h[h.length-1].balance:0;const g=x?-E:E,j=L.filter(w=>w.date>=N&&w.date<=c).map(w=>({...w,displayedBalance:x?-w.balance:w.balance})),P=j.length>0?j[j.length-1].displayedBalance:g;return{account:t,openingBalance:g,closingBalance:P,lines:j,isCreditNormal:x}},[r,T,p,b,N,c,S]),k=()=>{window.print()};return r==="WALLET"?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center bg-white p-2 rounded-xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex space-x-2 overflow-x-auto",children:[e.jsx("button",{onClick:()=>I("TB"),className:"px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-colors",children:"← Standard Reports"}),e.jsx("div",{className:"h-8 w-px bg-gray-300 mx-2 self-center"}),e.jsx("span",{className:"px-4 py-2 rounded-lg text-sm font-bold text-indigo-800 bg-indigo-50",children:"Wallet Report"})]})}),e.jsx(Y,{})]}):r==="TRANSIT"?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center bg-white p-2 rounded-xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex space-x-2 overflow-x-auto",children:[e.jsx("button",{onClick:()=>I("TB"),className:"px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-colors",children:"← Standard Reports"}),e.jsx("div",{className:"h-8 w-px bg-gray-300 mx-2 self-center"}),e.jsx("span",{className:"px-4 py-2 rounded-lg text-sm font-bold text-orange-800 bg-orange-50",children:"In-Transit Aging"})]})}),e.jsx(q,{})]}):r==="DELAYED"?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center bg-white p-2 rounded-xl shadow-sm border border-gray-100",children:e.jsxs("div",{className:"flex space-x-2 overflow-x-auto",children:[e.jsx("button",{onClick:()=>I("TB"),className:"px-4 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-colors",children:"← Standard Reports"}),e.jsx("div",{className:"h-8 w-px bg-gray-300 mx-2 self-center"}),e.jsx("span",{className:"px-4 py-2 rounded-lg text-sm font-bold text-red-800 bg-red-50",children:"Delayed Chats"})]})}),e.jsx(W,{})]}):e.jsxs("div",{className:"space-y-6 print:space-y-2",children:[e.jsx($,{className:"print:hidden",children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:[["TB","BS","IS","GL"].map(t=>e.jsx("button",{onClick:()=>I(t),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap ${r===t?"bg-indigo-100 text-indigo-700":"text-gray-600 hover:bg-gray-50"}`,children:a(t==="TB"?"trial_balance":t==="BS"?"balance_sheet":t==="IS"?"profit_loss":"general_ledger")},t)),e.jsx("div",{className:"h-8 w-px bg-gray-300 mx-2 self-center"}),e.jsx("button",{onClick:()=>I("WALLET"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap text-gray-600 hover:bg-gray-50",children:"Wallet Balances"}),e.jsx("button",{onClick:()=>I("TRANSIT"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap text-gray-600 hover:bg-gray-50",children:"In-Transit Aging"}),e.jsx("button",{onClick:()=>I("DELAYED"),className:"px-4 py-2 rounded-lg text-sm font-medium transition-colors whitespace-nowrap text-gray-600 hover:bg-gray-50",children:"Delayed Chats"})]}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs(_,{variant:"outline",onClick:k,children:[a("print")," / PDF"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t border-gray-100",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Branch"}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-indigo-500",value:b,onChange:t=>K(t.target.value),children:[e.jsx("option",{value:"",children:"All Branches"}),A.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),(r==="IS"||r==="GL")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:a("from_date")}),e.jsx("input",{type:"date",className:"block w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-indigo-500",value:N,onChange:t=>n(t.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:a(r==="IS"||r==="GL"?"to_date":"as_of")}),e.jsx("input",{type:"date",className:"block w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-indigo-500",value:c,onChange:t=>D(t.target.value)})]})]}),r==="GL"&&e.jsxs("div",{className:"pt-2",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Select Account"}),e.jsxs("select",{className:"block w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-indigo-500",value:T,onChange:t=>B(t.target.value),children:[e.jsx("option",{value:"",children:"-- Select an Account --"}),S.map(t=>e.jsxs("option",{value:t.id,children:[t.code," - ",t.name," (",t.type,")"]},t.id))]})]})]})}),e.jsx("div",{className:"print:block",children:e.jsxs($,{children:[e.jsxs("div",{className:"mb-6 pb-4 border-b border-gray-100 flex flex-col items-center text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:a(r==="TB"?"trial_balance":r==="IS"?"profit_loss":r==="BS"?"balance_sheet":"general_ledger")}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:b?(d=A.find(t=>t.id===b))==null?void 0:d.name:"All Branches"}),e.jsx("p",{className:"text-sm text-gray-500",children:r==="IS"||r==="GL"?`${a("from_date")} ${new Date(N).toLocaleDateString()} ${a("to_date")} ${new Date(c).toLocaleDateString()}`:`${a("as_of")} ${new Date(c).toLocaleDateString()}`}),r==="GL"&&y&&e.jsxs("div",{className:"mt-2 text-center",children:[e.jsxs("p",{className:"text-lg font-semibold text-indigo-700",children:[y.account.code," - ",y.account.name]}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-gray-100 text-gray-600 border border-gray-200 uppercase tracking-wide",children:y.account.type})]})]}),r==="TB"&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("code")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("account")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("debit")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("credit")})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200 text-sm",children:[f.map(t=>e.jsxs("tr",{className:t.isHeader?"bg-gray-50 font-bold":"",children:[e.jsx("td",{className:"px-6 py-2 text-gray-900",children:t.accountCode}),e.jsx("td",{className:"px-6 py-2 text-gray-900",children:e.jsxs("div",{style:{paddingLeft:`${t.depth*1.5}rem`},className:"flex items-center",children:[t.depth>0&&e.jsx("span",{className:"text-gray-300 mr-2",children:"↳"}),t.accountName]})}),e.jsx("td",{className:"px-6 py-2 text-right text-gray-600",children:t.debit>0?m(t.debit):"-"}),e.jsx("td",{className:"px-6 py-2 text-right text-gray-600",children:t.credit>0?m(t.credit):"-"})]},t.accountId)),e.jsxs("tr",{className:"bg-gray-100 font-bold",children:[e.jsx("td",{colSpan:2,className:"px-6 py-3 text-gray-900 text-right",children:a("grand_total")}),e.jsx("td",{className:"px-6 py-3 text-right text-indigo-700",children:m(i)}),e.jsx("td",{className:"px-6 py-3 text-right text-indigo-700",children:m(s)})]})]})]})}),r==="IS"&&e.jsxs("div",{className:"space-y-6 max-w-3xl mx-auto",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-bold text-gray-700 uppercase border-b border-gray-200 pb-2 mb-3",children:a("revenue")}),o.revenue.length===0&&e.jsx("p",{className:"text-gray-400 italic text-sm",children:"No revenue recorded."}),o.revenue.map(t=>e.jsx(H,{row:t,val:m(t.credit-t.debit)},t.accountId)),e.jsxs("div",{className:"flex justify-between font-bold text-sm py-2 border-t border-gray-200 mt-2",children:[e.jsx("span",{children:"Total Revenue"}),e.jsx("span",{children:m(o.totalRevenue)})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-bold text-gray-700 uppercase border-b border-gray-200 pb-2 mb-3",children:a("expenses")}),o.expenses.length===0&&e.jsx("p",{className:"text-gray-400 italic text-sm",children:"No expenses recorded."}),o.expenses.map(t=>e.jsx(H,{row:t,val:m(t.debit-t.credit)},t.accountId)),e.jsxs("div",{className:"flex justify-between font-bold text-sm py-2 border-t border-gray-200 mt-2",children:[e.jsx("span",{children:"Total Expenses"}),e.jsx("span",{children:m(o.totalExpenses)})]})]}),e.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg flex justify-between items-center print:bg-gray-50 print:border print:border-gray-300",children:[e.jsx("span",{className:"font-bold text-indigo-900 print:text-black",children:a("net_income")}),e.jsx("span",{className:`font-bold text-lg ${o.netIncome>=0?"text-green-600":"text-red-600"} print:text-black`,children:m(o.netIncome)})]})]}),r==="BS"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-bold text-gray-700 uppercase border-b border-gray-200 pb-2 mb-3",children:a("assets")}),l.assets.map(t=>e.jsx(H,{row:t,val:m(t.debit-t.credit)},t.accountId)),e.jsxs("div",{className:"flex justify-between font-bold text-sm py-3 mt-2 bg-gray-50 px-2 rounded print:bg-transparent print:border-t print:border-black",children:[e.jsx("span",{children:"Total Assets"}),e.jsx("span",{children:m(l.totalAssets)})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"text-md font-bold text-gray-700 uppercase border-b border-gray-200 pb-2 mb-3",children:a("liabilities")}),l.liabilities.map(t=>e.jsx(H,{row:t,val:m(t.credit-t.debit)},t.accountId)),e.jsxs("div",{className:"flex justify-between font-bold text-sm py-3 mt-2 bg-gray-50 px-2 rounded print:bg-transparent print:border-t print:border-black",children:[e.jsx("span",{children:"Total Liabilities"}),e.jsx("span",{children:m(l.totalLiabilities)})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-bold text-gray-700 uppercase border-b border-gray-200 pb-2 mb-3",children:a("equity")}),l.equity.map(t=>e.jsx(H,{row:t,val:m(t.credit-t.debit)},t.accountId)),e.jsxs("div",{className:"flex justify-between text-sm py-1 border-b border-gray-50 text-indigo-600 italic print:text-black",children:[e.jsx("div",{className:"pl-6",children:e.jsx("span",{children:"Calculated Earnings (Lifetime)"})}),e.jsx("span",{children:m(l.netIncome)})]}),e.jsxs("div",{className:"flex justify-between font-bold text-sm py-3 mt-2 bg-gray-50 px-2 rounded print:bg-transparent print:border-t print:border-black",children:[e.jsx("span",{children:"Total Equity"}),e.jsx("span",{children:m(l.totalEquity)})]}),e.jsxs("div",{className:"flex justify-between font-bold text-sm py-3 mt-4 border-t-2 border-gray-300",children:[e.jsx("span",{children:"Total Liab. & Equity"}),e.jsx("span",{children:m(l.totalLiabilities+l.totalEquity)})]})]})]})]}),r==="GL"&&e.jsx("div",{className:"space-y-4",children:T?y?e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("div",{className:"mb-4 bg-gray-50 p-3 rounded-lg flex justify-between items-center",children:[e.jsxs("span",{className:"font-medium text-gray-700",children:["Opening Balance (",new Date(N).toLocaleDateString(),")"]}),e.jsx("span",{className:"font-bold text-gray-900",children:m(y.openingBalance)})]}),e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("date")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("reference")}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("description")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("debit")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("credit")}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:a("balance")})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200 text-sm",children:[y.lines.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-gray-500",children:"No transactions in this period."})}),y.lines.map((t,x)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-900",children:t.date}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-gray-500",children:t.reference||"-"}),e.jsx("td",{className:"px-6 py-4 text-gray-900 max-w-xs truncate",title:t.description,children:t.description}),e.jsx("td",{className:"px-6 py-4 text-right text-gray-500",children:t.debit>0?m(t.debit):"-"}),e.jsx("td",{className:"px-6 py-4 text-right text-gray-500",children:t.credit>0?m(t.credit):"-"}),e.jsx("td",{className:`px-6 py-4 text-right font-medium ${t.displayedBalance<0?"text-red-600":"text-gray-900"}`,children:m(t.displayedBalance)})]},x))]})]}),e.jsxs("div",{className:"mt-4 bg-gray-50 p-3 rounded-lg flex justify-between items-center border-t border-gray-200",children:[e.jsxs("span",{className:"font-medium text-gray-700",children:["Closing Balance (",new Date(c).toLocaleDateString(),")"]}),e.jsx("span",{className:"font-bold text-gray-900",children:m(y.closingBalance)})]})]}):null:e.jsx("div",{className:"text-center py-12 text-gray-500",children:e.jsx("p",{children:"Please select an account above to view its General Ledger."})})})]})})]})};function ae(){const{transactions:p,accounts:S,branches:A}=O();return e.jsx(V,{transactions:p,accounts:S,branches:A})}export{ae as default};
