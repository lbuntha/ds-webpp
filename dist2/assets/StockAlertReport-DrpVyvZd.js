import{h as L,r,s as I,j as e}from"./index-BjK2osQV.js";import{T as B}from"./triangle-alert-CU0jYjXD.js";import{c as T}from"./createLucideIcon-D09dZYGY.js";import{D as A}from"./download-CgA0qWHs.js";import{F as R}from"./funnel-BH7WirRk.js";import{P as E}from"./package-Dvi4dam4.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],M=T("refresh-cw",$),V=()=>{const{branches:x}=L(),[a,h]=r.useState([]),[m,p]=r.useState([]),[c,u]=r.useState("all"),[o,g]=r.useState(10),[y,d]=r.useState(!0);r.useEffect(()=>{b()},[]),r.useEffect(()=>{i()},[c,o]);const b=()=>{p(x)},i=async()=>{d(!0);try{const t=c==="all"?void 0:c,l=await I.getLowStockItems(t,o);h(l)}catch(t){console.error("Error loading low stock items:",t)}finally{d(!1)}},j=()=>{const t=["Customer","Branch","Product","SKU","Total Qty","Reserved","Available"],l=a.map(s=>[s.customerName,s.branchName,s.item.productName,s.item.sku||"",s.item.quantity.toString(),s.item.reservedQuantity.toString(),s.availableQuantity.toString()]),S=[t.join(","),...l.map(s=>s.map(Q=>`"${Q}"`).join(","))].join(`
`),C=new Blob([S],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");n.href=URL.createObjectURL(C),n.download=`low-stock-report-${new Date().toISOString().split("T")[0]}.csv`,n.click()},f=t=>t<=0?"bg-red-100 text-red-800 border-red-200":t<=5?"bg-orange-100 text-orange-800 border-orange-200":"bg-yellow-100 text-yellow-800 border-yellow-200",N=t=>t<=0?"Out of Stock":t<=5?"Critical":"Low",v=a.filter(t=>t.availableQuantity<=0).length,w=a.filter(t=>t.availableQuantity>0&&t.availableQuantity<=5).length,k=a.filter(t=>t.availableQuantity>5).length;return y?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(B,{className:"w-8 h-8 text-orange-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Stock Alerts"}),e.jsx("p",{className:"text-gray-500",children:"Monitor low stock levels across locations"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx(M,{className:"w-4 h-4"}),"Refresh"]}),e.jsxs("button",{onClick:j,disabled:a.length===0,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:[e.jsx(A,{className:"w-4 h-4"}),"Export CSV"]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-start md:items-center bg-white p-4 rounded-lg shadow border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-700",children:"Filters:"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Branch"}),e.jsxs("select",{value:c,onChange:t=>u(t.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"All Branches"}),m.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-500 mb-1",children:"Threshold"}),e.jsxs("select",{value:o,onChange:t=>g(parseInt(t.target.value)),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:5,children:"≤ 5 units"}),e.jsx("option",{value:10,children:"≤ 10 units"}),e.jsx("option",{value:20,children:"≤ 20 units"}),e.jsx("option",{value:50,children:"≤ 50 units"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 border border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Total Alerts"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.length})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg shadow p-4 border border-red-200",children:[e.jsx("p",{className:"text-sm text-red-600",children:"Out of Stock"}),e.jsx("p",{className:"text-2xl font-bold text-red-700",children:v})]}),e.jsxs("div",{className:"bg-orange-50 rounded-lg shadow p-4 border border-orange-200",children:[e.jsx("p",{className:"text-sm text-orange-600",children:"Critical (1-5)"}),e.jsx("p",{className:"text-2xl font-bold text-orange-700",children:w})]}),e.jsxs("div",{className:"bg-yellow-50 rounded-lg shadow p-4 border border-yellow-200",children:[e.jsxs("p",{className:"text-sm text-yellow-600",children:["Low (",">","5)"]}),e.jsx("p",{className:"text-2xl font-bold text-yellow-700",children:k})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 overflow-hidden",children:a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(E,{className:"w-12 h-12 mx-auto text-gray-400 mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No low stock alerts"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"All products have sufficient inventory"})]}):e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Customer"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Branch"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Product"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Total"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Reserved"}),e.jsx("th",{className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Available"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:a.map((t,l)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${f(t.availableQuantity)}`,children:N(t.availableQuantity)})}),e.jsx("td",{className:"px-4 py-3 font-medium text-gray-900",children:t.customerName}),e.jsx("td",{className:"px-4 py-3 text-gray-500",children:t.branchName}),e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("span",{className:"font-medium text-gray-900",children:t.item.productName}),t.item.sku&&e.jsxs("span",{className:"text-xs text-gray-400 ml-2",children:["(",t.item.sku,")"]})]}),e.jsx("td",{className:"px-4 py-3 text-right font-medium",children:t.item.quantity}),e.jsx("td",{className:"px-4 py-3 text-right text-orange-600",children:t.item.reservedQuantity}),e.jsx("td",{className:`px-4 py-3 text-right font-bold ${t.availableQuantity<=0?"text-red-600":t.availableQuantity<=5?"text-orange-600":"text-yellow-600"}`,children:t.availableQuantity})]},`${t.customerId}-${t.item.id}-${l}`))})]})})]})};export{V as StockAlertReport,V as default};
