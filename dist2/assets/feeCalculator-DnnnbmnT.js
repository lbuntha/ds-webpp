import{p as S}from"./index-BjK2osQV.js";async function D(u){const{serviceTypeId:i,customerId:n,itemCount:m,codCurrency:r,exchangeRate:R=4100,services:p,specialRates:v}=u,I=r==="KHR",a=p.find(e=>e.id===i);if(!a)return console.warn("⚠️ Service not found for fee calculation:",i,"Available:",p.map(e=>e.id)),{fee:0,currency:r,isSpecialRate:!1,pricePerItem:0,pricePerItemUSD:0,pricePerItemKHR:0};let t=v;if(!t&&n)try{t=await S.getCustomerSpecialRates(n)}catch(e){console.error("Failed to fetch special rates:",e),t=[]}let s=a.defaultPrice||0,l=a.defaultPriceKHR||0,f=!1;if(t&&t.length>0){const e=new Date().toISOString().split("T")[0],c=t.find(o=>o.serviceTypeId===i&&o.startDate.split("T")[0]<=e&&o.endDate.split("T")[0]>=e);c&&(s=c.price,l=c.priceKHR||c.price*R,f=!0)}const d=I?l:s;return{fee:d*Math.max(m,1),currency:r,isSpecialRate:f,pricePerItem:d,pricePerItemUSD:s,pricePerItemKHR:l}}export{D as calculateDeliveryFee};
