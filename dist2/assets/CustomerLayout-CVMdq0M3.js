import{u as y,g as C,r as o,j as e,f as O}from"./index-BjK2osQV.js";import{C as S}from"./CustomerDashboard-deNiRKiN.js";import{C as E}from"./CustomerProfile-BIYUM9pb.js";import{C as L}from"./CustomerBooking-oYDmisNq.js";import{C as R}from"./CustomerSummaryReport-CSt5d_g8.js";import{N as A}from"./NotificationBell-BxF3YRgp.js";import{L as M}from"./LanguageSwitcher-D3yQfyql.js";import{W as T}from"./WalletDashboard-Bzjm7O1a.js";import{C as p}from"./Card-DROeE3UG.js";import{P as _}from"./PublicTracker-MdOHTl6U.js";import"./TrackingTimeline-keA493kc.js";import"./toast-DTXa3ATd.js";import"./ChatModal-Bzjxc4YC.js";import"./Button-JCYNVMjR.js";import"./Input-B96Hj4QL.js";import"./Avatar-BzcIcvYu.js";import"./ImageUpload-CVnIZI_m.js";import"./Modal-B63ndL_a.js";import"./LocationPicker-BMHhAdnZ.js";import"./PlaceAutocomplete-IKHODmB-.js";import"./Toast-DvmjtaFo.js";import"./imageUtils-D2x4nXU4.js";const re=({user:s,onLogout:l})=>{var f;const{t}=y(),{hasPermission:i}=C(),[c,d]=o.useState(!1),[g,j]=o.useState(!1),[v,b]=o.useState(!0),[w,h]=o.useState(!1);o.useEffect(()=>{(async()=>{if(s.linkedCustomerId)try{const n=await O.getDocument("customers",s.linkedCustomerId);n&&n.status==="INACTIVE"&&j(!0)}catch(n){console.error("Failed to check customer status",n)}b(!1)})()},[s]);const u=o.useMemo(()=>[{id:"DASHBOARD",permission:"CUSTOMER_VIEW_DASHBOARD",label:t("dashboard"),icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})})},{id:"WALLET",permission:"CUSTOMER_ACCESS_WALLET",label:t("wallet"),icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})},{id:"BOOKING",permission:"CUSTOMER_CREATE_BOOKING",label:t("new_booking"),icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})})},{id:"REPORTS",permission:"CUSTOMER_VIEW_REPORTS",label:t("spending_report"),icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},{id:"PROFILE",permission:"CUSTOMER_MANAGE_PROFILE",label:t("my_profile"),icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}],[t]),m=o.useMemo(()=>u.filter(a=>i(s,a.permission)),[u,s,i]),[r,N]=o.useState(((f=m[0])==null?void 0:f.id)||"PROFILE"),k=()=>d(!c),x=a=>{N(a),d(!1)};return v?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 text-gray-500",children:t("loading")}):g?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:e.jsxs(p,{className:"max-w-md w-full text-center border-t-4 border-red-600 shadow-xl p-8",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"bg-red-50 p-6 rounded-full animate-pulse",children:e.jsx("svg",{className:"w-16 h-16 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Account Suspended"}),e.jsxs("p",{className:"text-gray-600 mb-8 leading-relaxed",children:["Your customer account has been deactivated. You cannot access the booking system or view your history.",e.jsx("br",{}),e.jsx("br",{}),"Please contact support to reactivate your account."]}),e.jsx("button",{onClick:l,className:"w-full py-3 bg-gray-900 text-white rounded-xl hover:bg-gray-800 transition-colors font-medium",children:t("signOut")})]})}):m.length===0?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs(p,{className:"max-w-md w-full text-center shadow-xl p-8",children:[e.jsx("div",{className:"mb-4",children:e.jsx("svg",{className:"w-16 h-16 mx-auto text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"No Access"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"You don't have access to any customer features. Please contact your administrator."}),e.jsx("button",{onClick:l,className:"w-full py-3 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors font-medium",children:t("signOut")})]})}):e.jsxs("div",{className:"flex h-screen bg-gray-50 overflow-hidden",children:[c&&e.jsx("div",{className:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 backdrop-blur-sm md:hidden",onClick:()=>d(!1)}),e.jsxs("aside",{className:`
            fixed inset-y-0 left-0 z-40 w-64 bg-slate-900 text-white transform transition-transform duration-300 ease-in-out flex flex-col shadow-2xl
            ${c?"translate-x-0":"-translate-x-full"}
            md:relative md:translate-x-0
        `,children:[e.jsxs("div",{className:"h-16 flex items-center px-6 border-b border-slate-800 bg-slate-950",children:[e.jsx("div",{className:"h-8 w-8 bg-red-600 rounded-lg flex items-center justify-center text-white font-bold shadow-lg shadow-red-900/50 mr-3",children:"D"}),e.jsx("span",{className:"text-lg font-bold tracking-tight",children:"Doorstep"})]}),e.jsx("nav",{className:"flex-1 px-3 py-6 space-y-1 overflow-y-auto",children:m.map(a=>e.jsxs("button",{onClick:()=>x(a.id),className:`w-full flex items-center px-4 py-3 text-sm font-medium rounded-xl transition-all duration-200 group ${r===a.id?"bg-red-600 text-white shadow-lg shadow-red-900/20":"text-slate-300 hover:bg-slate-800 hover:text-white"}`,children:[e.jsx("span",{className:`mr-3 transition-colors ${r===a.id?"text-white":"text-slate-400 group-hover:text-white"}`,children:a.icon}),a.label]},a.id))}),e.jsxs("div",{className:"p-4 border-t border-slate-800 bg-slate-950",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"h-9 w-9 rounded-full bg-slate-700 flex items-center justify-center text-sm font-bold text-white border border-slate-600",children:s.name.charAt(0)}),e.jsxs("div",{className:"ml-3 overflow-hidden",children:[e.jsx("p",{className:"text-sm font-medium text-white truncate",children:s.name}),e.jsx("p",{className:"text-xs text-slate-400 truncate",children:"Customer Account"})]})]}),e.jsxs("button",{onClick:l,className:"w-full py-2 px-4 border border-slate-700 rounded-lg text-xs font-medium text-slate-300 hover:bg-slate-800 hover:text-white transition-colors flex items-center justify-center hover:border-slate-600",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})}),t("signOut")]})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 overflow-hidden",children:[e.jsxs("header",{className:"h-16 bg-white border-b border-gray-200 flex justify-between items-center px-4 sm:px-6 lg:px-8 shadow-sm z-20 relative",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsxs("button",{onClick:k,className:"p-2 -ml-2 mr-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none md:hidden",children:[e.jsx("span",{className:"sr-only",children:"Open sidebar"}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})]}),e.jsxs("h1",{className:"text-xl font-bold text-gray-800 tracking-tight",children:[r==="DASHBOARD"&&t("dashboard"),r==="BOOKING"&&t("new_booking"),r==="PROFILE"&&t("my_profile"),r==="REPORTS"&&t("delivery_reports"),r==="WALLET"&&t("my_wallet")]})]}),e.jsxs("div",{className:"flex items-center space-x-3 sm:space-x-4",children:[e.jsxs("button",{onClick:()=>h(!0),className:"hidden md:flex items-center text-xs font-medium text-gray-600 bg-gray-100 px-3 py-1.5 rounded-full hover:bg-gray-200 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4 mr-1.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})}),"Track Shipment"]}),e.jsx(M,{}),e.jsx(A,{user:s}),e.jsxs("div",{className:"hidden sm:flex items-center",children:[e.jsx("div",{className:"h-8 w-px bg-gray-200 mx-4"}),e.jsxs("div",{className:"text-right mr-3",children:[e.jsx("div",{className:"text-xs text-gray-500",children:"Signed in as"}),e.jsx("div",{className:"text-sm font-medium text-gray-900 truncate max-w-[150px]",children:s.email})]}),e.jsx("div",{className:"h-8 w-8 rounded-full bg-red-100 text-red-600 flex items-center justify-center font-bold text-xs",children:s.name.charAt(0)})]})]})]}),e.jsx("main",{className:"flex-1 overflow-y-auto focus:outline-none bg-gray-50 p-4 sm:p-6 lg:p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[r==="DASHBOARD"&&i(s,"CUSTOMER_VIEW_DASHBOARD")&&e.jsx(S,{user:s,onNewBooking:()=>x("BOOKING")}),r==="PROFILE"&&i(s,"CUSTOMER_MANAGE_PROFILE")&&e.jsx(E,{user:s}),r==="BOOKING"&&i(s,"CUSTOMER_CREATE_BOOKING")&&e.jsx(L,{user:s,onComplete:()=>x("DASHBOARD")}),r==="REPORTS"&&i(s,"CUSTOMER_VIEW_REPORTS")&&e.jsx(R,{user:s}),r==="WALLET"&&i(s,"CUSTOMER_ACCESS_WALLET")&&e.jsx(T,{user:s})]})})]}),w&&e.jsx(_,{onClose:()=>h(!1)})]})};export{re as CustomerLayout};
