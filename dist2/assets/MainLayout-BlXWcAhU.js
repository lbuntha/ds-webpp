import{z as A,h as y,u as I,$ as R,r as w,j as e,a0 as C,b as T,a1 as L}from"./index-BjK2osQV.js";import{N as O}from"./NotificationBell-BxF3YRgp.js";import{L as _}from"./LanguageSwitcher-D3yQfyql.js";import{M}from"./MenuIcon-DZT_vwr1.js";import"./Toast-DvmjtaFo.js";const P=({className:n})=>e.jsx("svg",{className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),$=({className:n})=>e.jsx("svg",{className:n,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})});function K({menuItems:n,user:i,onLogout:m,isMobileOpen:u=!1,onMobileClose:d,badges:v={}}){const p=A(),{settings:h}=y(),{t:a}=I(),c=R(),[t,g]=w.useState(()=>localStorage.getItem("sidebar-collapsed")==="true");w.useEffect(()=>{localStorage.setItem("sidebar-collapsed",String(t))},[t]);const b=()=>g(!t),j=w.useMemo(()=>{const s=n.filter(r=>r.hidden?!1:i.role==="system-admin"?!0:!(r.allowedRoles&&r.allowedRoles.length>0&&!r.allowedRoles.includes(i.role)||r.requiredPermission&&!c.includes(r.requiredPermission)||!(r.allowedRoles&&r.allowedRoles.length>0||r.requiredPermission))),l=r=>{const o=(r||"").toLowerCase();return o?o==="warehouse"||o==="logistics"?10:o==="driver"?15:o==="customer"?18:o==="finance"?20:o==="employee"?30:o==="reports"?40:o==="system"?90:50:0};return s.sort((r,o)=>{const x=l(r.section),f=l(o.section);return x!==f?x-f:r.order-o.order})},[n,i.role,c]),k=s=>{const l=p.pathname,r=`/app/${s.toLowerCase().replace(/_/g,"/")}`;return l.startsWith(r)},E=s=>s.viewId==="CUSTOMER_SETTLEMENTS"?"/app/customer-settlements":s.viewId==="SETTLED_PARCELS"?"/app/settled-parcels":s.viewId==="CASHBACK"?"/app/cashback":s.viewId==="CASHBACK_REPORT"?"/app/cashback-report":s.viewId==="BOOKING_MAP"?"/app/reports/booking-map":s.viewId==="BOOKING_STATUS_DRIVER"?"/app/reports/booking-status-driver":s.viewId==="STOCK_MANAGEMENT"?"/app/stock":s.viewId==="STOCK_ALERTS"?"/app/stock/alerts":s.viewId==="STOCK_REQUESTS"?"/app/stock/requests":s.viewId==="CUSTOMER_STOCK"?"/app/customer/stock":s.viewId==="CUSTOMER_PRODUCTS"?"/app/customer/products":s.viewId==="CUSTOMER_STOCK_REQUESTS"?"/app/customer/stock-requests":s.viewId==="CUSTOMER_STOCK_BOOKING"?"/app/customer/stock-booking":s.viewId.startsWith("CUSTOMER_")?`/app/customer/${s.viewId.replace("CUSTOMER_","").toLowerCase()}`:s.viewId.startsWith("DRIVER_")?`/app/driver/${s.viewId.replace("DRIVER_","").toLowerCase()}`:s.viewId==="STAFF_LOAN_ISSUE"?"/app/staff/issue-loan":s.viewId==="DELAYED_CHATS"?"/app/parcels/delayed-chats":s.viewId==="STANDARD_EXPENSES"?"/app/expenses/standard":s.viewId==="EXPENSE_TEMPLATES"?"/app/expenses/templates":`/app/${s.viewId.toLowerCase().replace(/_/g,"/")}`,N=()=>{d&&d()};return e.jsxs("div",{className:`
                fixed inset-y-0 left-0 z-40 bg-slate-900 text-white flex-col shadow-xl transition-transform duration-300 ease-in-out
                ${u?"translate-x-0":"-translate-x-full"}
                md:relative md:translate-x-0 md:flex md:flex-shrink-0
                ${t?"md:w-16":"md:w-64"}
                w-64 h-[100dvh] md:h-auto
            `,children:[e.jsx("button",{onClick:b,className:"hidden md:flex absolute -right-3 top-6 w-6 h-6 bg-slate-700 hover:bg-red-600 rounded-full items-center justify-center shadow-lg transition-all duration-200 border-2 border-slate-900 z-30",title:t?"Expand sidebar":"Collapse sidebar",children:t?e.jsx($,{className:"w-3 h-3 text-white"}):e.jsx(P,{className:"w-3 h-3 text-white"})}),e.jsxs("div",{className:`p-4 flex items-center ${t?"md:justify-center":"space-x-3"} border-b border-slate-800`,children:[e.jsx("img",{src:"/logo/icon.png",alt:"DoorStep Logo",className:"h-8 w-8 object-contain flex-shrink-0"}),e.jsx("span",{className:`font-bold text-lg truncate tracking-tight transition-opacity duration-200 ${t?"md:hidden":""}`,children:h.companyName||"Doorstep"})]}),e.jsx("nav",{className:"flex-1 overflow-y-auto py-4 space-y-1 sidebar-scroll overscroll-y-contain",children:j.map((s,l)=>{var S;const r=E(s),o=k(s.viewId),x=l>0?j[l-1]:null,f=s.section&&(!x||x.section!==s.section);return e.jsxs("div",{children:[f&&e.jsx("div",{className:`pt-4 pb-2 px-6 text-xs text-slate-500 font-bold uppercase tracking-wider ${t?"md:hidden":""}`,children:((S=s.section)==null?void 0:S.toLowerCase())==="system"?a("system"):s.section}),f&&t&&e.jsx("div",{className:"hidden md:flex pt-4 pb-1 justify-center",children:e.jsx("div",{className:"w-6 h-px bg-slate-700"})}),e.jsxs(C,{to:r,onClick:N,className:`w-full flex items-center px-6 py-3 text-sm font-medium transition-all duration-200 
                                    ${o?"bg-slate-800 border-l-4 border-red-600 text-white":"hover:bg-slate-800 text-slate-400 hover:text-white"}
                                    ${t?"md:justify-center md:px-2":""}
                                `,title:t?a(s.label):void 0,children:[e.jsx("span",{className:t?"md:mr-0 mr-3":"mr-3",children:e.jsx(M,{iconKey:s.iconKey,className:"w-5 h-5"})}),e.jsx("span",{className:`truncate transition-opacity duration-200 flex-1 ${t?"md:hidden":""}`,children:a(s.label)}),v[s.viewId]>0&&e.jsx("span",{className:`bg-red-600 text-white text-[10px] font-bold px-1.5 py-0.5 rounded-full ${t?"absolute top-2 right-2 md:top-0 md:right-0":"ml-2"}`,children:v[s.viewId]>99?"99+":v[s.viewId]})]})]},s.id)})}),e.jsxs("div",{className:`p-4 border-t border-slate-800 bg-slate-900 ${t?"md:p-2":""}`,children:[e.jsxs(C,{to:"/app/profile",onClick:N,className:`flex items-center w-full text-left group ${t?"md:justify-center":""}`,children:[e.jsx("div",{className:"h-8 w-8 rounded-full bg-red-600 flex items-center justify-center text-xs font-bold text-white group-hover:bg-red-500 transition-colors shadow-md flex-shrink-0",children:i.name.charAt(0)}),e.jsxs("div",{className:`ml-3 flex-1 overflow-hidden ${t?"md:hidden":""}`,children:[e.jsx("div",{className:"text-sm font-medium truncate text-white group-hover:text-red-200 transition-colors",children:i.name}),e.jsx("div",{className:"text-xs text-slate-400 truncate",children:(i.role||"").replace("-"," ")})]})]}),e.jsx("div",{className:`${t?"md:hidden":""}`,children:e.jsx("button",{onClick:m,className:"mt-3 w-full text-center text-xs text-slate-400 hover:text-white transition-colors py-1 hover:bg-slate-800 rounded",children:a("signOut")})}),t&&e.jsx("button",{onClick:m,className:"hidden md:flex mt-2 w-full justify-center text-slate-400 hover:text-white transition-colors py-1 hover:bg-slate-800 rounded",title:a("signOut"),children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]})]})}function H(){const{user:n,logout:i}=T(),{menuItems:m,transactions:u,pendingWalletRequests:d}=y(),{t:v}=I(),[p,h]=w.useState(!1),a=(u==null?void 0:u.filter(b=>b.status==="PENDING_APPROVAL").length)||0,c=(d==null?void 0:d.length)||0,g={BANKING:a+c,APPROVALS:a,REQUESTS:c,BANKING_APPROVALS:a,BANKING_REQUESTS:c};return n?e.jsxs("div",{className:"flex h-screen bg-gray-100",children:[p&&e.jsx("div",{className:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 backdrop-blur-sm md:hidden",onClick:()=>h(!1)}),e.jsx(K,{menuItems:m,user:n,onLogout:i,isMobileOpen:p,onMobileClose:()=>h(!1),badges:g}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 bg-gray-50 transition-all duration-300",children:[e.jsxs("header",{className:"bg-white border-b border-gray-200 px-4 sm:px-8 py-3 flex justify-between items-center shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>h(!0),className:"p-2 -ml-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none md:hidden",children:[e.jsx("span",{className:"sr-only",children:"Open sidebar"}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})]}),e.jsx("h2",{className:"text-lg font-bold text-gray-800 capitalize hidden sm:block"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(_,{}),e.jsx(O,{user:n}),e.jsx("div",{className:"h-8 w-px bg-gray-200 hidden sm:block"}),e.jsxs("div",{className:"text-xs text-right hidden sm:block",children:[e.jsx("div",{className:"font-bold text-gray-900",children:n.name}),e.jsx("div",{className:"text-gray-500",children:n.role})]})]})]}),e.jsx("div",{className:`flex-1 p-4 sm:p-8 ${p?"overflow-hidden":"overflow-auto"}`,children:e.jsx(L,{})})]})]}):null}export{H as default};
