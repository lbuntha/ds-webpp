import{a as k,c as C,r as l,j as e,f as u}from"./index-BjK2osQV.js";import{B as x}from"./Button-JCYNVMjR.js";import{g}from"./errorUtils-CUS756ws.js";function D(){const m=k(),[c]=C(),[r,h]=l.useState("PHONE"),[a,p]=l.useState(c.get("phone")||""),[o,y]=l.useState(""),[i,v]=l.useState(""),[d,n]=l.useState(!1),[b,t]=l.useState(null),[N,P]=l.useState(null),[j,O]=l.useState(null);l.useEffect(()=>{c.get("phone")&&p(c.get("phone")||"")},[c]);const w=async()=>{if(!a.trim()){t("Please enter your phone number");return}n(!0),t(null);try{const s=await u.requestOTP(a.trim(),"RESET");if(s.success){const f=await u.getOTP(a.trim());f.code&&O(f.code),h("OTP")}else t(s.message)}catch(s){t(g(s))}finally{n(!1)}},E=async()=>{if(!o.trim()||o.length!==6){t("Please enter the 6-digit code");return}n(!0),t(null);try{const s=await u.verifyOTP(a.trim(),o);s.success?h("NEW_PASSWORD"):t(s.message)}catch(s){t(g(s))}finally{n(!1)}},S=async()=>{if(!i||i.length<4){t("PIN must be at least 4 characters");return}n(!0),t(null);try{const s=await u.resetPasswordWithOTP(a.trim(),o,i);s.success?(P("PIN reset successfully! You can now log in with your new PIN."),setTimeout(()=>{m("/auth/login",{replace:!0})},3e3)):t(s.message)}catch(s){t(s.message||g(s))}finally{n(!1)}};return e.jsxs("div",{className:"min-h-screen flex flex-row bg-white",children:[e.jsxs("div",{className:"hidden lg:flex lg:w-5/12 bg-slate-900 relative overflow-hidden flex-col justify-between p-12 text-white",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-10",children:[e.jsx("img",{src:"/logo/icon.png",alt:"Doorstep",className:"h-8 w-8 object-contain"}),e.jsx("span",{className:"text-2xl font-bold tracking-tight text-white drop-shadow-sm",children:"Doorstep"})]}),e.jsx("h1",{className:"text-4xl font-extrabold leading-tight mb-6",children:"Reset Your Password"}),e.jsx("p",{className:"text-slate-400 text-lg leading-relaxed max-w-md",children:"Forgot your password? No problem. Verify your phone number and set a new one in seconds."})]}),e.jsx("div",{className:"absolute -bottom-20 -right-20 w-80 h-80 bg-red-600/10 rounded-full blur-3xl"})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("button",{onClick:()=>r==="PHONE"?m("/auth/login"):h(r==="OTP"?"PHONE":"OTP"),className:"flex items-center gap-2 text-slate-500 hover:text-slate-700 mb-8 transition-colors",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back"]}),e.jsx("div",{className:"bg-white p-8 rounded-2xl shadow-sm border border-gray-100",children:N?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Success!"}),e.jsx("p",{className:"text-slate-600",children:N}),e.jsx(x,{onClick:()=>m("/auth/login"),className:"w-full mt-8",children:"Go to Login"})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-3xl",children:"ðŸ”‘"})})}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:r==="PHONE"?"Enter Phone Number":r==="OTP"?"Verify Code":"New Password"}),e.jsx("p",{className:"mt-2 text-sm text-slate-600",children:r==="PHONE"?"We'll send a code to reset your password":r==="OTP"?`Enter the code sent to ${a}`:"Choose a new strong password"})]}),b&&e.jsx("div",{className:"mb-6 p-4 rounded-lg bg-red-50 border border-red-200 text-red-700 text-sm",children:b}),j&&r==="OTP"&&e.jsxs("div",{className:"mb-6 p-4 rounded-lg bg-blue-50 border border-blue-200 text-blue-700 text-sm",children:[e.jsx("strong",{children:"Dev Mode:"})," Your OTP is ",e.jsx("code",{className:"font-mono bg-blue-100 px-2 py-1 rounded",children:j})]}),r==="PHONE"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:a,onChange:s=>p(s.target.value),placeholder:"e.g., 012 345 678",className:"w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-red-500 focus:ring-2 focus:ring-red-200 transition-all text-lg",autoFocus:!0})]}),e.jsx(x,{onClick:w,isLoading:d,className:"w-full py-3",children:"Send Reset Code"})]}),r==="OTP"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Verification Code"}),e.jsx("input",{type:"text",value:o,onChange:s=>y(s.target.value.replace(/\D/g,"").slice(0,6)),placeholder:"Enter 6-digit code",className:"w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-red-500 focus:ring-2 focus:ring-red-200 transition-all text-lg text-center tracking-widest font-mono",maxLength:6,autoFocus:!0})]}),e.jsx(x,{onClick:E,isLoading:d,className:"w-full py-3",children:"Verify Code"}),e.jsx("button",{onClick:w,className:"w-full text-sm text-red-600 hover:text-red-700",disabled:d,children:"Resend Code"})]}),r==="NEW_PASSWORD"&&e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"New Password"}),e.jsx("input",{type:"password",value:i,onChange:s=>v(s.target.value),placeholder:"Enter 6+ characters",className:"w-full px-4 py-3 rounded-xl border border-gray-300 focus:border-red-500 focus:ring-2 focus:ring-red-200 transition-all",autoFocus:!0})]}),e.jsx(x,{onClick:S,isLoading:d,className:"w-full py-3",children:"Reset Password"})]}),e.jsx("div",{className:"flex justify-center mt-8 gap-2",children:["PHONE","OTP","NEW_PASSWORD"].map((s,f)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${r===s?"bg-red-600":"bg-gray-300"}`},s))})]})})]})})]})}export{D as default};
