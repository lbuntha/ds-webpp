const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BxcSyS5K.js","assets/index-BjK2osQV.js","assets/index-CY9_X8xj.css"])))=>i.map(i=>d[i]);
import{r as u,R as D,j as e,f as E,_ as Y}from"./index-BjK2osQV.js";import{C as ae}from"./Card-DROeE3UG.js";import{B as I}from"./Button-JCYNVMjR.js";import{t as d}from"./toast-DTXa3ATd.js";const ne=()=>{var K,Q,q;const[v,G]=u.useState([]),[J,X]=u.useState([]),[h,Z]=u.useState([]),[ee,$]=u.useState(!1),[m,H]=u.useState(null),[i,R]=u.useState(null),B=async()=>{$(!0);const[t,s]=await Promise.all([E.getParcelBookings(),E.getEmployees()]);X(t),G(t.filter(r=>r.status!=="COMPLETED"&&r.status!=="CANCELLED")),Z(s.filter(r=>r.isDriver&&r.status!=="INACTIVE")),$(!1)},A=t=>{const s=t.linkedUserId||t.id,r=J.flatMap(l=>(l.items||[]).filter(a=>(a.driverId===s||a.delivererId===s)&&a.status==="DELIVERED"&&(!a.driverSettlementStatus||a.driverSettlementStatus==="UNSETTLED")));let n=0,c=0,x=0,o=0;return r.forEach(l=>{const a=Number(l.productPrice)||0;a>0&&(l.codCurrency==="KHR"?c+=a:n+=a),l.isTaxiDelivery&&l.taxiFee&&l.taxiFee>0&&!l.taxiFeeReimbursed&&(l.taxiFeeCurrency==="KHR"?o+=l.taxiFee:x+=l.taxiFee)}),{usd:n-x,khr:c-o,itemCount:r.length}},L=t=>{const s=A(t),r=Math.abs(s.usd)<.01,n=Math.abs(s.khr)<1;return r&&n};u.useEffect(()=>{B()},[]);const M=v.flatMap(t=>(t.items||[]).filter(s=>s.status==="AT_WAREHOUSE").map(s=>({bookingId:t.id,bookingRef:t.senderName,item:s}))),[U,w]=u.useState(""),_=D.useRef(null),[O,y]=u.useState(!1),[P,W]=u.useState(!1),[z,b]=u.useState(!1),[j,k]=u.useState(!1);u.useEffect(()=>{i&&_.current&&_.current.focus()},[i]);const te=t=>{const s=t.trim();if(!s)return;const r=h.find(n=>n.employeeCode===s||n.id===s||n.linkedUserId===s);if(r)if(L(r))R(r.id),d.success(`Driver selected: ${r.name}`);else{const n=A(r);d.error(`${r.name} is BLOCKED. Owes: ${Math.abs(n.usd)>.01?`$${n.usd.toFixed(2)}`:""} ${Math.abs(n.khr)>1?`${n.khr.toLocaleString()} KHR`:""}`)}else d.error(`Driver not found: ${s}`);b(!1)},g=D.useRef(null),C=D.useRef(!1);u.useEffect(()=>{if(!z)return;let t=!0;return(async()=>{try{const{Html5Qrcode:r}=await Y(async()=>{const{Html5Qrcode:a}=await import("./index-BxcSyS5K.js");return{Html5Qrcode:a}},__vite__mapDeps([0,1,2]));if(await new Promise(a=>setTimeout(a,150)),!t)return;if(!document.getElementById("driver-qr-reader")){console.error("Driver scanner element not found");return}const c=new r("driver-qr-reader");g.current=c;const x={fps:10,qrbox:{width:250,height:250},aspectRatio:1},o=a=>{te(a),C.current=!1,c.stop().catch(()=>{})},l=()=>{};try{await c.start({facingMode:"environment"},x,o,l),C.current=!0}catch(a){console.warn("Back camera failed for driver scan:",a);try{await c.start({facingMode:"user"},x,o,l),C.current=!0}catch(f){console.error("All cameras failed:",f),d.error("Camera access denied or not available"),b(!1)}}}catch(r){console.error("Driver scanner init failed:",r),d.error("Failed to start camera"),t&&b(!1)}})(),()=>{t=!1,g.current&&C.current?(C.current=!1,g.current.stop().then(()=>{g.current&&(g.current.clear(),g.current=null)}).catch(()=>{g.current=null})):g.current=null}},[z,h]);const p=D.useRef(null),S=D.useRef(!1);u.useEffect(()=>{if(!O)return;let t=!0;return(async()=>{try{const{Html5Qrcode:r}=await Y(async()=>{const{Html5Qrcode:a}=await import("./index-BxcSyS5K.js");return{Html5Qrcode:a}},__vite__mapDeps([0,1,2]));if(await new Promise(a=>setTimeout(a,150)),!t)return;if(!document.getElementById("dispatch-reader")){console.error("Scanner element not found");return}const c=new r("dispatch-reader");p.current=c;const x={fps:10,qrbox:{width:250,height:250},aspectRatio:1},o=a=>{w(a),V(a),S.current=!1,c.stop().then(()=>{y(!1)}).catch(()=>{})},l=()=>{};try{await c.start({facingMode:"environment"},x,o,l),S.current=!0}catch(a){console.warn("Back camera failed, trying front camera:",a);try{await c.start({facingMode:"user"},x,o,l),S.current=!0}catch(f){console.error("All cameras failed:",f),d.error("Camera access denied or not available"),y(!1)}}}catch(r){console.error("Scanner initialization failed:",r),d.error("Failed to start camera"),t&&y(!1)}})(),()=>{t=!1,p.current&&S.current?(S.current=!1,p.current.stop().then(()=>{p.current&&(p.current.clear(),p.current=null)}).catch(()=>{p.current=null})):p.current=null}},[O]);const F=async(t,s)=>{const r=h.find(o=>o.id===s),n=v.find(o=>o.id===t.bookingId);if(!n||!r)return;if(!L(r)){d.error(`Cannot assign: ${r.name} has unsettled balance.`);return}const c=r.linkedUserId||r.id,x=(n.items||[]).map(o=>o.id===t.item.id?{...o,status:"OUT_FOR_DELIVERY",driverId:c,driverName:r.name,targetBranchId:null}:o);try{const o={...n,items:x,involvedDriverIds:Array.from(new Set([...n.involvedDriverIds||[],c]))};if(await E.saveParcelBooking(o),r.linkedUserId){const l={id:`notif-wh-${Date.now()}`,targetAudience:r.linkedUserId,title:"Warehouse Pickup Assigned",message:`Collect item for ${t.item.receiverName} from Warehouse for delivery.`,type:"INFO",read:!1,createdAt:Date.now()};await E.sendNotification(l)}d.success(`Assigned ${t.item.receiverName} (Scan) to ${r.name}`),B()}catch(o){console.error(o),d.error("Failed to assign item.")}},se=async()=>{!m||!i||(await F(m,i),H(null),R(null))},V=async t=>{if(!i)return;const s=t.trim();if(s){W(!0);try{const r=M.find(a=>a.item.barcode===s||a.item.trackingCode===s||a.item.id===s);if(r){await F(r,i),w("");return}let n=null,c=null,x=null;const l=(a=>{for(const f of a){const N=(f.items||[]).find(T=>T.barcode===s||T.trackingCode===s||T.id===s);if(N)return{item:N,booking:f}}return null})(v);if(l)n=l.item.status,c=l.item,x=l.booking;else try{const a=await E.findBookingByBarcode(s);if(a){const f=(a.items||[]).find(N=>N.barcode===s||N.trackingCode===s||N.id===s);f&&(n=f.status,c=f,x=a)}}catch(a){console.error("Backend search failed",a)}c&&x&&n?n==="AT_WAREHOUSE"?(await F({bookingId:x.id,item:c},i),w("")):n==="OUT_FOR_DELIVERY"?d.error("Parcel is already Out for Delivery."):n==="IN_TRANSIT"?d.error("Parcel is In Transit."):n==="DELIVERED"?d.error("Parcel is already Delivered."):n==="PENDING"?d.error("Parcel is PENDING (Not picked up yet)."):d.error(`Parcel status is ${n}. Must be AT_WAREHOUSE.`):d.error(`Parcel not found: ${s}`),w("")}catch(r){console.error("Scan Error",r),d.error("Scanning failed.")}finally{W(!1)}}},re=async t=>{t.key==="Enter"&&i&&(t.preventDefault(),V(U))};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Dispatch Console"}),e.jsx(I,{variant:"outline",onClick:B,isLoading:ee,className:"text-xs",children:"Refresh"})]}),e.jsxs("div",{className:"block lg:grid lg:grid-cols-3 gap-6 pb-24 lg:pb-0",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-4 mb-4 lg:mb-0",children:[e.jsx("div",{className:"flex justify-between items-center mb-2",children:e.jsxs("h3",{className:"text-lg font-bold text-gray-700",children:["Warehouse Inventory (",M.length,")"]})}),e.jsxs("div",{className:"space-y-4",children:[M.map((t,s)=>e.jsxs("div",{onClick:()=>{H({bookingId:t.bookingId,item:t.item}),window.innerWidth<1024&&k(!0)},className:`p-4 border rounded-xl cursor-pointer transition-all bg-white relative overflow-hidden ${(m==null?void 0:m.item.id)===t.item.id?"ring-2 ring-indigo-500 border-indigo-500":"border-gray-200 hover:border-indigo-300"}`,children:[(m==null?void 0:m.item.id)===t.item.id&&e.jsx("div",{className:"absolute left-0 top-0 bottom-0 w-1 bg-indigo-500"}),e.jsxs("div",{className:"flex gap-4 pl-2",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden border border-gray-200 flex-shrink-0",children:e.jsx("img",{src:t.item.image,className:"w-full h-full object-cover",alt:"item"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("h4",{className:"font-bold text-gray-900",children:t.item.receiverName}),e.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded font-bold",children:"At Warehouse"})]}),e.jsx("p",{className:"text-xs text-gray-500 truncate mt-1",children:t.item.destinationAddress}),e.jsxs("p",{className:"text-[10px] text-gray-400 mt-1",children:["From Booking: ",t.bookingRef]})]})]})]},s)),M.length===0&&e.jsx("p",{className:"text-center py-12 text-gray-400",children:"Warehouse is empty."})]})]}),j&&e.jsx("div",{className:"lg:hidden fixed inset-0 bg-black/50 z-30 transition-opacity",onClick:()=>k(!1)}),e.jsxs("div",{className:`
                    fixed bottom-0 left-0 right-0 z-40 bg-white rounded-t-2xl shadow-[0_-5px_25px_-5px_rgba(0,0,0,0.1)] transition-transform duration-300 ease-in-out
                    lg:static lg:z-auto lg:bg-transparent lg:shadow-none lg:rounded-none lg:transform-none lg:block
                    ${j?"translate-y-0":"translate-y-[calc(100%-80px)] lg:translate-y-0"}
                    h-[80vh] lg:h-auto
                `,children:[e.jsxs("div",{className:"lg:hidden h-36 w-full flex flex-col items-center pt-2 cursor-pointer bg-white rounded-t-2xl absolute top-0 left-0",onClick:()=>k(!j),children:[e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full mb-3"}),e.jsxs("div",{className:"px-4 w-full flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800",children:m?"Assign Driver":"Select Item / Driver"}),(m||i)&&e.jsx("p",{className:"text-xs text-indigo-600",children:i?"Driver Selected":"1 Item Selected"})]}),e.jsx(I,{variant:j?"secondary":"primary",onClick:t=>{t.stopPropagation(),k(!j)},className:"px-3 py-1.5 text-sm",children:j?"Close":"Expand"})]})]}),e.jsx("div",{className:"h-full pt-16 lg:pt-0 overflow-y-auto lg:overflow-visible px-4 lg:px-0 bg-white lg:bg-transparent",children:e.jsx(ae,{title:"Assign Driver",className:"h-fit min-h-[50vh] lg:min-h-0 lg:max-h-[85vh] flex flex-col shadow-none border-0 lg:border lg:shadow-sm lg:sticky lg:top-6",children:e.jsxs("div",{className:"space-y-4 flex-1 flex flex-col",children:[!m&&!i?e.jsxs("div",{className:"text-center py-6 text-gray-400 flex flex-col items-center bg-gray-50 rounded-xl border border-dashed border-gray-300 mb-4",children:[e.jsx("svg",{className:"w-12 h-12 mb-2 opacity-50 text-indigo-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Select a driver to start dispatching"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Scan driver QR or select from list below"}),e.jsx("div",{className:"mt-4",children:e.jsxs(I,{variant:"outline",onClick:()=>b(!0),className:"bg-white px-3 py-1.5 text-sm",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"Scan Driver QR"]})})]}):e.jsxs(e.Fragment,{children:[i&&e.jsx(e.Fragment,{children:L(h.find(t=>t.id===i))?e.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg border-2 border-indigo-200 mb-2 animate-fade-in-up",children:[e.jsxs("label",{className:"block text-xs font-bold uppercase text-indigo-700 mb-1",children:["SCAN PARCEL FOR ",(K=h.find(t=>t.id===i))==null?void 0:K.name]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx("input",{ref:_,type:"text",className:"w-full px-3 py-2 border rounded shadow-sm focus:ring-2 focus:ring-indigo-500 focus:outline-none pr-8",placeholder:P?"Searching...":"Scan Barcode / Tracking ID...",value:U,onChange:t=>w(t.target.value),onKeyDown:re,autoFocus:!0,disabled:P}),P&&e.jsx("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2",children:e.jsxs("svg",{className:"animate-spin h-5 w-5 text-indigo-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})})]}),e.jsx(I,{onClick:()=>y(!0),className:"px-3 bg-indigo-600 hover:bg-indigo-700",title:"Scan with Camera",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 13a3 3 0 11-6 0 3 3 0 016 0z"})]})})]}),e.jsx("p",{className:"text-[10px] text-indigo-400 mt-1",children:"Press Enter to assign instantly."})]}):e.jsxs("div",{className:"bg-red-50 p-4 rounded-lg border-2 border-red-200 mb-2 text-center",children:[e.jsx("div",{className:"flex justify-center mb-2",children:e.jsx("span",{className:"p-2 bg-red-100 rounded-full",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})})}),e.jsx("h3",{className:"text-sm font-bold text-red-800 uppercase",children:"Assignment Blocked"}),e.jsxs("p",{className:"text-xs text-red-600 mt-1",children:[(Q=h.find(t=>t.id===i))==null?void 0:Q.name," has an unsettled wallet balance."]})]})}),i&&e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-2",children:e.jsxs("p",{className:"text-xs font-bold text-gray-500 uppercase",children:["Assigned to ",(q=h.find(t=>t.id===i))==null?void 0:q.name.split(" ")[0],"(",v.flatMap(t=>(t.items||[]).filter(s=>s.driverId===i&&s.status==="OUT_FOR_DELIVERY")).length,")"]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg border border-gray-200 max-h-[150px] overflow-y-auto divide-y divide-gray-100",children:[v.flatMap(t=>(t.items||[]).filter(s=>s.driverId===i&&s.status==="OUT_FOR_DELIVERY").map(s=>({...s,bookingRef:t.id}))).map(t=>e.jsxs("div",{className:"p-2 flex justify-between items-center text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[e.jsx("div",{className:"w-1 h-8 bg-green-500 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"truncate",children:[e.jsx("p",{className:"font-medium text-gray-800 truncate",children:t.receiverName}),e.jsx("p",{className:"text-xs text-gray-400",children:t.trackingCode||t.id.slice(-6)})]})]}),e.jsx("span",{className:"text-[10px] bg-green-100 text-green-700 px-1.5 py-0.5 rounded ml-2 whitespace-nowrap",children:"Out"})]},t.id)),v.flatMap(t=>(t.items||[]).filter(s=>s.driverId===i&&s.status==="OUT_FOR_DELIVERY")).length===0&&e.jsx("p",{className:"text-xs text-gray-400 text-center py-4",children:"No parcels assigned yet."})]})]}),m&&e.jsxs("div",{className:"bg-indigo-50 p-3 rounded-lg text-sm text-indigo-800 border border-indigo-100 mb-2",children:[e.jsx("span",{className:"block text-xs font-bold uppercase text-indigo-400 mb-1",children:"Selected Parcel"}),`Deliver ${m==null?void 0:m.item.receiverName}'s parcel`]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto pr-2 space-y-2 max-h-[400px]",children:[e.jsxs("div",{className:"flex justify-between items-center sticky top-0 bg-white pb-2 z-10",children:[e.jsxs("p",{className:"text-xs font-bold text-gray-500 uppercase",children:["Available Drivers (",h.length,")"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[i&&e.jsxs("button",{onClick:t=>{t.stopPropagation(),R(null)},className:"flex items-center gap-1 text-xs text-red-600 hover:text-red-800 font-medium px-2 py-1 rounded hover:bg-red-50 transition-colors",title:"Clear selected driver",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Reset"]}),e.jsxs("button",{onClick:()=>b(!0),className:"flex items-center gap-1 text-xs text-indigo-600 hover:text-indigo-800 font-medium px-2 py-1 rounded hover:bg-indigo-50 transition-colors",title:"Scan Driver QR Code",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h.01M5 8h2a1 1 0 001-1V5a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1zm12 0h2a1 1 0 001-1V5a1 1 0 00-1-1h-2a1 1 0 00-1 1v2a1 1 0 001 1zM5 20h2a1 1 0 001-1v-2a1 1 0 00-1-1H5a1 1 0 00-1 1v2a1 1 0 001 1z"})}),"Scan Driver"]})]})]}),h.map(t=>{const s=L(t),r=A(t);return e.jsxs("div",{onClick:()=>R(t.id),className:`p-3 rounded-lg border flex items-center space-x-3 transition-all cursor-pointer ${i===t.id?"bg-green-50 border-green-500 ring-1 ring-green-500":s?"bg-white border-gray-200 hover:bg-gray-50":"bg-red-50 border-red-200 opacity-80"}`,children:[e.jsxs("div",{className:"h-9 w-9 bg-gray-200 rounded-full flex items-center justify-center text-xs font-bold text-gray-600 relative",children:[t.name.charAt(0),t.linkedUserId&&e.jsx("span",{className:"absolute -bottom-1 -right-1 h-3 w-3 bg-green-500 border-2 border-white rounded-full",title:"App Connected"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.name}),!s&&e.jsx("span",{className:"text-[10px] font-bold text-red-600 bg-red-100 px-1.5 rounded",children:"BLOCKED"})]}),e.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-[10px] text-gray-500 bg-gray-100 px-1.5 rounded",children:t.vehicleType}),t.zone&&e.jsx("span",{className:"text-[10px] text-blue-500 bg-blue-50 px-1.5 rounded",children:t.zone})]}),!s&&e.jsxs("p",{className:"text-[10px] text-red-600 font-medium",children:["Owes:",Math.abs(r.usd)>.01&&` $${r.usd.toFixed(2)}`,Math.abs(r.khr)>1&&` ${r.khr.toLocaleString()} KHR`]})]})]}),i===t.id&&e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]},t.id)}),h.length===0&&e.jsx("p",{className:"text-xs text-red-500 text-center py-4",children:"No active drivers found."})]}),m&&e.jsx(I,{className:"w-full mt-4",disabled:!i,onClick:()=>{se(),window.innerWidth<1024&&k(!1)},children:"Confirm Assignment"})]})})})]})]}),O&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-90 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden relative",children:[e.jsxs("div",{className:"p-4 bg-gray-100 flex justify-between items-center border-b border-gray-200",children:[e.jsx("h3",{className:"font-bold text-gray-800",children:"Scan Barcode / QR"}),e.jsx("button",{onClick:()=>y(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4",children:e.jsx("div",{id:"dispatch-reader",className:"w-full"})}),e.jsx("div",{className:"p-4 bg-gray-50 text-center text-xs text-gray-500",children:"Point camera at the parcel barcode to assign instantly."})]})}),z&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-90 backdrop-blur-sm p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md overflow-hidden relative",children:[e.jsxs("div",{className:"p-4 bg-indigo-600 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-white flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),"Scan Driver Badge"]}),e.jsx("button",{onClick:()=>b(!1),className:"text-white hover:text-indigo-200",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"p-4",children:e.jsx("div",{id:"driver-qr-reader",className:"w-full"})}),e.jsxs("div",{className:"p-4 bg-indigo-50 text-center",children:[e.jsx("p",{className:"text-xs text-indigo-600 font-medium",children:"Point camera at driver's employee badge QR code"}),e.jsx("p",{className:"text-[10px] text-indigo-400 mt-1",children:"Scans employeeCode to auto-select driver"})]})]})})]})};function de(){return e.jsx(ne,{})}export{de as default};
