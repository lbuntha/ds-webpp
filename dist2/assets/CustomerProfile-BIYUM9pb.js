import{u as Be,r,j as e,f as c}from"./index-BjK2osQV.js";import{C as p}from"./Card-DROeE3UG.js";import{B as u}from"./Button-JCYNVMjR.js";import{I as b}from"./Input-B96Hj4QL.js";import{A as Te}from"./Avatar-BzcIcvYu.js";import{I as Re}from"./ImageUpload-CVnIZI_m.js";import{M as Me}from"./Modal-B63ndL_a.js";import{L as De}from"./LocationPicker-BMHhAdnZ.js";import{P as Pe}from"./PlaceAutocomplete-IKHODmB-.js";import{t as d}from"./toast-DTXa3ATd.js";const Oe=({user:l,hideExchangeRate:oe})=>{var ne,le;const{t:a}=Be(),[_,de]=r.useState(l.name),[A,ie]=r.useState(l.phone||""),[S,ce]=r.useState(l.address||""),[G,v]=r.useState(!1),[N,O]=r.useState(""),[j,k]=r.useState([]),[xe,B]=r.useState(!1),[T,Y]=r.useState(""),[R,w]=r.useState(""),[h,M]=r.useState(""),[g,D]=r.useState(""),[me,P]=r.useState(!1),[E,U]=r.useState(null),[z,I]=r.useState(null),[Q,ue]=r.useState(null),[pe,V]=r.useState(!1),[s,m]=r.useState(null),[he,F]=r.useState(!1),[q,K]=r.useState(""),[$,Z]=r.useState(""),[y,J]=r.useState(""),[H,C]=r.useState(!1),[W,X]=r.useState(""),[ge,ee]=r.useState(!1),[te,fe]=r.useState(4100),[be,L]=r.useState(!1),[ae,se]=r.useState(!1);r.useEffect(()=>{(async()=>{const o=(await c.getCurrencies()).find(x=>x.code==="KHR");o&&fe(o.exchangeRate);let i;if(l.linkedCustomerId){const x=await c.getDocument("customers",l.linkedCustomerId);x&&(i=x)}else i=(await c.getCustomers()).find(f=>f.linkedUserId===l.uid);i&&(m(i),i.customExchangeRate&&X(i.customExchangeRate),i.savedLocations&&i.savedLocations.length>0&&k(i.savedLocations),i.referralCode&&O(i.referralCode))})(),l.role==="driver"&&(async()=>{V(!0);try{const o=await c.hrService.getEmployeeByUserId(l.uid);ue(o)}catch(o){console.error("Error loading employee data",o)}finally{V(!1)}})()},[l.uid,l.linkedCustomerId,l.role]),r.useEffect(()=>{(async()=>{if(!N){const n=l.name.replace(/[^a-zA-Z]/g,"").toUpperCase(),o=n.length>=3?n.substring(0,3):(n+"USR").substring(0,3),i=Math.floor(1e3+Math.random()*9e3),x=`${o}-${i}`;try{if(s){const f={...s,referralCode:x};await c.updateCustomer(f),m(f)}else await c.updateUserProfile(l.name,{referralCode:x});O(x)}catch(f){console.error("Failed to generate referral code",f)}}})()},[l.uid,l.name,N,s]);const je=async t=>{t.preventDefault(),v(!0);try{await c.updateUserProfile(_,{phone:A,address:S}),s&&m({...s,name:_,phone:A,address:S}),d.success(a("profile_updated"))}catch(n){console.error(n),d.error("Error updating profile.")}finally{v(!1)}},ye=async()=>{if(s){ee(!0);try{const t={...s,customExchangeRate:W?Number(W):void 0};await c.updateCustomer(t),m(t),d.success(a("rate_updated_success"))}catch(t){console.error(t),d.error(a("rate_updated_error"))}finally{ee(!1)}}},ve=(t,n,o)=>{M(t),D(n),w(o),P(!1)},Ne=async()=>{if(!T||!R)return d.warning("Label and Address are required.");v(!0);let t;typeof h=="number"&&typeof g=="number"&&!isNaN(h)&&!isNaN(g)&&(t={lat:h,lng:g});const n={id:`loc-${Date.now()}`,label:T,address:R,coordinates:t,isPrimary:j.length===0},o=[...j,n];try{await c.updateUserLocations(o),s&&m({...s,savedLocations:o}),k(o),B(!1),Y(""),w(""),M(""),D("")}catch(i){console.error(i),d.error("Failed to save location.")}finally{v(!1)}},ke=t=>{U(t)},we=async()=>{if(!E)return;const t=j.filter(n=>n.id!==E);try{await c.updateUserLocations(t),s&&m({...s,savedLocations:t}),k(t),U(null),d.success(a("location_deleted")||"Location deleted")}catch{d.error("Failed to delete.")}},Ce=async t=>{const n=j.map(o=>({...o,isPrimary:o.id===t}));if(s){const o={...s,savedLocations:n};await c.updateCustomer(o),m(o)}else await c.updateUserLocations(n);k(n)},re=async()=>{C(!0);try{await c.createCustomerFromUser(l),d.success(a("profile_updated")),window.location.reload()}catch(t){console.error(t),d.error("Failed to initialize wallet profile.")}finally{C(!1)}},Le=async()=>{var i;if(!s)return;if(!q||!$)return d.warning("Bank Name and Account Number are required.");if((((i=s.bankAccounts)==null?void 0:i.length)||0)>=2)return d.warning(a("max_bank_limit"));C(!0);let t=y;y&&y.startsWith("data:")&&(t=await c.walletService.uploadAttachment(y));const n={bankName:q,accountNumber:$,qrCode:t},o={...s,bankAccounts:[...s.bankAccounts||[],n]};try{await c.updateCustomer(o),m(o),F(!1),K(""),Z(""),J("")}catch(x){console.error(x),d.error("Failed to save bank account.")}finally{C(!1)}},_e=t=>{I(t)},Ae=async()=>{if(!s||z===null)return;const t=[...s.bankAccounts||[]];t.splice(z,1);const n={...s,bankAccounts:t};try{await c.updateCustomer(n),m(n),I(null),d.success(a("bank_deleted")||"Bank account deleted")}catch{d.error("Failed to delete.")}},Se=s&&(((ne=s.bankAccounts)==null?void 0:ne.length)||0)<2;return e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6 pb-20",children:[e.jsxs(p,{children:[e.jsxs("div",{className:"flex items-center gap-4 border-b border-gray-100 pb-6 mb-6",children:[e.jsx(Te,{name:l.name,size:"lg"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:l.name}),e.jsx("p",{className:"text-gray-500",children:l.email})]})]}),e.jsxs("form",{onSubmit:je,className:"space-y-4",children:[e.jsx(b,{label:a("full_name"),value:_,onChange:t=>de(t.target.value)}),e.jsx(b,{label:a("phone_number"),value:A,onChange:t=>ie(t.target.value)}),e.jsx(b,{label:a("default_address"),value:S,onChange:t=>ce(t.target.value),placeholder:"House, Street, City..."}),e.jsx("div",{className:"pt-2 flex justify-end",children:e.jsx(u,{type:"submit",isLoading:G,children:a("save_basic_info")})})]})]}),e.jsx(p,{title:"Telegram Notifications",children:s!=null&&s.telegramChatId?e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center text-green-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-green-900",children:"Connected to Telegram"}),e.jsx("p",{className:"text-sm text-green-700",children:s.telegramChatType==="group"||s.telegramChatType==="supergroup"?`Notifications sent to group: ${s.telegramGroupName||"Group Chat"}`:"Notifications sent to your private chat"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:`text-xs px-2 py-1 rounded-full font-medium ${s.telegramChatType==="group"||s.telegramChatType==="supergroup"?"bg-purple-100 text-purple-700":"bg-green-100 text-green-700"}`,children:s.telegramChatType==="group"||s.telegramChatType==="supergroup"?"ðŸ‘¥ Group":"ðŸ‘¤ Private"})})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-green-200 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsx("p",{className:"text-xs text-green-600",children:"You can unlink and connect to a different chat anytime."}),e.jsx("button",{onClick:()=>L(!0),className:"text-sm text-red-600 hover:text-red-800 font-medium px-3 py-1.5 rounded-lg border border-red-200 hover:bg-red-50 transition-colors",children:"Unlink Telegram"})]}),e.jsx(Me,{isOpen:be,onClose:()=>L(!1),title:"Unlink Telegram",maxWidth:"max-w-md",children:e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"mx-auto flex h-12 w-12 items-center justify-center rounded-full bg-red-100 mb-4",children:e.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Disconnect from Telegram?"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"You will stop receiving notifications on Telegram. You can reconnect anytime using your private chat or a group."}),e.jsxs("div",{className:"flex gap-3 justify-center",children:[e.jsx(u,{variant:"outline",onClick:()=>L(!1),disabled:ae,children:"Cancel"}),e.jsx(u,{className:"bg-red-600 hover:bg-red-700 text-white",isLoading:ae,onClick:async()=>{se(!0);try{const t={...s,telegramChatId:void 0,telegramChatType:void 0,telegramGroupName:void 0,telegramLinkedAt:void 0,telegramLinkedBy:void 0};await c.updateCustomer(t),m(t),L(!1),d.success("Telegram unlinked successfully")}catch(t){console.error(t),d.error("Failed to unlink Telegram")}finally{se(!1)}},children:"Unlink"})]})]})})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 text-blue-500 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})})}),e.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"Get Instant Notifications"}),e.jsx("p",{className:"text-gray-600 mb-4 text-sm max-w-md mx-auto",children:"Receive settlement reports and payment updates directly on Telegram."}),e.jsxs("a",{href:`https://t.me/DSDelivery_bot?start=${l.uid}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-[#0088cc] hover:bg-[#0077b5] shadow-sm transition-all transform hover:scale-105",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})}),"Connect via Private Chat"]})]}),s&&e.jsx("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-5",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 text-purple-600 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-purple-900 mb-1",children:"Link to Group Chat"}),e.jsx("p",{className:"text-sm text-purple-700 mb-4",children:"Add the bot to your Telegram group so your whole team can see notifications."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("a",{href:`https://t.me/DSDelivery_bot?startgroup=link_${s.code||s.id||""}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center px-4 py-2 border border-purple-300 text-sm font-medium rounded-lg text-purple-700 bg-white hover:bg-purple-100 shadow-sm transition-all",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"})}),"Add Bot to Group"]}),e.jsxs("div",{className:"text-xs text-purple-600 bg-purple-100/50 rounded-lg p-3",children:[e.jsx("p",{className:"font-medium mb-1",children:"After adding the bot, send this command in the group:"}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs("code",{className:"bg-white px-2 py-1 rounded font-mono text-purple-800 text-xs break-all",children:["/link ",s.code||s.id||"YOUR_CODE"]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(`/link ${s.code||s.id||"YOUR_CODE"}`),d.success("Command copied!")},className:"text-purple-600 hover:text-purple-800 font-medium",children:"Copy"})]})]})]})]})]})})]})}),!oe&&e.jsx(p,{title:"Exchange Rate Preferences",children:s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-100 p-4 rounded-xl mb-4 text-sm text-blue-800",children:[e.jsx("p",{className:"font-bold mb-1",children:a("daily_rate_title")}),e.jsx("p",{children:a("cod_rate_expl").replace("{0}",te.toLocaleString())})]}),e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a("custom_rate_label")}),e.jsx("input",{type:"number",className:"block w-full px-3 py-2 border border-gray-300 rounded-xl shadow-sm focus:outline-none focus:ring-indigo-500 sm:text-sm font-bold text-gray-900",placeholder:`System Default: ${te}`,value:W,onChange:t=>X(t.target.value===""?"":parseFloat(t.target.value))})]}),e.jsx(u,{onClick:ye,isLoading:ge,className:"mb-[1px]",children:a("update_rate")})]})]}):e.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-xl border border-gray-200",children:[e.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:a("need_billing_profile")}),e.jsx(u,{onClick:re,isLoading:H,children:a("init_wallet_profile")})]})}),s&&e.jsx(p,{title:"Tax Configuration",children:e.jsxs("div",{className:"flex items-center bg-gray-50 p-4 rounded-lg border border-gray-200",children:[e.jsx("input",{id:"isTaxableCust",type:"checkbox",className:"h-5 w-5 text-gray-400 border-gray-300 rounded cursor-not-allowed",checked:s.isTaxable||!1,disabled:!0}),e.jsxs("div",{className:"ml-3",children:[e.jsx("label",{htmlFor:"isTaxableCust",className:"block text-sm font-bold text-gray-700",children:s.isTaxable?"VAT/Tax Applied":"No Tax Applied"}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Tax configuration is managed by the administrator."})]})]})}),s&&e.jsxs(p,{title:"Special Rates",children:[e.jsxs("div",{className:"bg-purple-50 border border-purple-100 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"text-sm font-bold text-purple-900 mb-1",children:"Custom Pricing"}),e.jsx("p",{className:"text-xs text-purple-700",children:"Special rates configured by the administrator will be automatically applied when you book a parcel."})]}),e.jsx("div",{className:"text-center py-4 border-2 border-dashed border-gray-100 rounded-lg",children:e.jsx("p",{className:"text-xs text-gray-400",children:"Contact support to request special pricing"})})]}),e.jsx(p,{title:a("bank_accounts"),children:l.role==="driver"?e.jsx("div",{className:"space-y-4",children:Q?e.jsx("div",{className:"border border-gray-200 rounded-xl p-4 flex items-center justify-between gap-4 bg-blue-50/50 hover:border-blue-200 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center text-blue-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:"Official Bank Account"}),e.jsx("p",{className:"text-sm text-gray-600 font-mono",children:Q.bankAccount||"Not set in employee profile"}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1 uppercase font-bold tracking-wider",children:"Managed by Administration"})]})]})}):pe?e.jsx("div",{className:"text-center py-6 text-gray-500 text-sm",children:"Loading bank info..."}):e.jsx("div",{className:"text-center py-6 bg-gray-50 rounded-xl border border-gray-200",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"No employee record found for your account."})})}):s?e.jsxs("div",{className:"space-y-4",children:[s.bankAccounts&&s.bankAccounts.map((t,n)=>e.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 flex flex-col sm:flex-row sm:items-center justify-between gap-4 hover:border-blue-200 transition-colors bg-white",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[t.qrCode?e.jsx("img",{src:t.qrCode,alt:"QR",className:"w-16 h-16 object-contain rounded-lg border border-gray-200 bg-gray-50"}):e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex items-center justify-center text-gray-400",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:t.bankName}),e.jsx("p",{className:"text-sm text-gray-600 font-mono",children:t.accountNumber}),t.qrCode&&e.jsx("span",{className:"text-[10px] text-green-600 font-medium bg-green-50 px-2 py-0.5 rounded",children:a("qr_enabled")})]})]}),z===n?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Ae,className:"text-xs text-red-600 font-bold hover:underline px-2 py-1 bg-red-50 rounded",children:a("confirm")}),e.jsx("button",{onClick:()=>I(null),className:"text-xs text-gray-600 hover:underline px-2 py-1 bg-gray-100 rounded",children:a("cancel")})]}):e.jsx("button",{onClick:()=>_e(n),className:"text-xs text-red-600 hover:underline font-medium px-2 py-1 rounded hover:bg-red-50",children:a("remove")})]},n)),he?e.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100 animate-fade-in-up",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-800 mb-3",children:a("add_bank_account")}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(b,{label:a("bank_name"),value:q,onChange:t=>K(t.target.value),placeholder:"e.g. ABA Bank, ACLEDA"}),e.jsx(b,{label:a("account_no"),value:$,onChange:t=>Z(t.target.value),placeholder:"000 000 000"}),e.jsx(Re,{label:a("qr_code_label"),value:y,onChange:J}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx(u,{variant:"outline",onClick:()=>F(!1),className:"text-xs",children:a("cancel")}),e.jsx(u,{onClick:Le,isLoading:H,className:"text-xs",children:a("save_account")})]})]})]}):Se?e.jsxs("button",{onClick:()=>F(!0),className:"w-full py-3 border-2 border-dashed border-gray-300 rounded-xl text-gray-500 font-medium hover:border-blue-300 hover:text-blue-600 transition-all flex items-center justify-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),a("add_bank_account")," (",((le=s.bankAccounts)==null?void 0:le.length)||0,"/2)"]}):e.jsx("div",{className:"text-center text-xs text-gray-400 py-2",children:a("max_bank_limit")})]}):e.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-xl border border-gray-200",children:[e.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:a("need_billing_profile")}),e.jsx(u,{onClick:re,isLoading:H,children:a("init_wallet_profile")})]})}),l.role!=="driver"&&e.jsx(p,{title:a("saved_locations"),children:e.jsxs("div",{className:"space-y-4",children:[j.map(t=>e.jsxs("div",{className:"border border-gray-200 rounded-xl p-4 flex flex-col sm:flex-row sm:items-center justify-between gap-4 hover:border-red-200 transition-colors bg-white",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-bold text-gray-900",children:t.label}),t.isPrimary&&e.jsx("span",{className:"bg-red-100 text-red-700 text-[10px] px-2 py-0.5 rounded-full font-bold",children:a("primary_badge")})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.address}),t.coordinates&&e.jsxs("p",{className:"text-xs text-gray-400 mt-1 font-mono",children:[(t.coordinates.lat||0).toFixed(5),", ",(t.coordinates.lng||0).toFixed(5)]})]}),e.jsxs("div",{className:"flex gap-2",children:[!t.isPrimary&&e.jsx("button",{onClick:()=>Ce(t.id),className:"text-xs text-indigo-600 hover:underline",children:a("set_primary")}),E===t.id?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:we,className:"text-xs text-red-600 font-bold hover:underline px-2 py-1 bg-red-50 rounded",children:a("confirm")}),e.jsx("button",{onClick:()=>U(null),className:"text-xs text-gray-600 hover:underline px-2 py-1 bg-gray-100 rounded",children:a("cancel")})]}):e.jsx("button",{onClick:()=>ke(t.id),className:"text-xs text-red-600 hover:underline",children:a("delete")})]})]},t.id)),xe?e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl border border-gray-200 animate-fade-in-up",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-800 mb-3",children:a("add_new_location")}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(b,{label:a("loc_label_placeholder"),value:T,onChange:t=>Y(t.target.value),placeholder:"Home, Office, Warehouse A..."}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a("address_coordinates")}),e.jsx(Pe,{value:R,onChange:w,onSelect:t=>{w(t.address||t.name),t.location&&(M(t.location.lat),D(t.location.lng))},onPickMap:()=>P(!0),placeholder:a("enter_address_placeholder"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm focus:ring-red-500 focus:border-red-500"}),h!==""&&g!==""&&e.jsxs("p",{className:"text-xs text-green-600 mt-1 flex items-center",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),a("coordinates_set"),": ",Number(h).toFixed(6),", ",Number(g).toFixed(6)]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx(u,{variant:"outline",onClick:()=>B(!1),className:"text-xs",children:a("cancel")}),e.jsx(u,{onClick:Ne,isLoading:G,className:"text-xs",children:a("save_location")})]})]})]}):e.jsxs("button",{onClick:()=>B(!0),className:"w-full py-3 border-2 border-dashed border-gray-300 rounded-xl text-gray-500 font-medium hover:border-red-300 hover:text-red-600 transition-all flex items-center justify-center",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),a("add_new_location")]})]})}),me&&e.jsx(De,{initialLat:typeof h=="number"?h:void 0,initialLng:typeof g=="number"?g:void 0,onConfirm:ve,onClose:()=>P(!1)}),e.jsx(p,{title:a("referral_program"),children:e.jsxs("div",{className:"bg-red-50 p-6 rounded-xl text-center border border-red-100",children:[e.jsx("p",{className:"text-red-800 font-medium mb-2",children:a("referral_code_title")}),e.jsx("div",{className:"text-3xl font-mono font-bold text-red-600 tracking-widest mb-4 bg-white inline-block px-6 py-2 rounded-lg border border-red-200 shadow-sm",children:N||"Generating..."}),e.jsx("p",{className:"text-sm text-red-600",children:a("referral_desc")}),l.referralStats&&e.jsxs("div",{className:"mt-6 grid grid-cols-2 gap-4 border-t border-red-200 pt-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-500 uppercase font-bold",children:"Total Referrals"}),e.jsx("p",{className:"text-xl font-bold text-red-900",children:l.referralStats.count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-red-500 uppercase font-bold",children:"Total Earned"}),e.jsxs("p",{className:"text-xl font-bold text-red-900",children:["$",(l.referralStats.earnings||0).toFixed(2)]})]})]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(N||""),d.success(a("copied"))},className:"mt-4 text-xs font-bold text-red-700 hover:underline uppercase",children:a("copy_code")})]})})]})};export{Oe as C};
